<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="../../util/docbook/schema/docbookspec.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
<?xml-model href="../../util/docbook/schema/docbookspec.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<?xml-model href="../../util/docbook/schema/docbook.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<book xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:epub="http://www.idpf.org/2011/epub" version="5.1" xml:lang="en">
    <title>EPUB 3.1</title>
    <info>
        <releaseinfo>Editor's Draft</releaseinfo>
        <pubdate>30 January 2016</pubdate>
        <printhistory>
            <formalpara>
                <title>This version</title>
                <para><link xlink:href="http://www.idpf.org/epub/31/spec/epub-spec-20160130.html"/></para>
            </formalpara>
            <formalpara>
                <title>Latest version</title>
                <para><link xlink:href="http://www.idpf.org/epub3/latest"/></para>
            </formalpara>
            <formalpara>
                <title>Previous version</title>
                <para>N/A</para>
            </formalpara>
            <formalpara>
                <title>Previous recommendation</title>
                <para><link xlink:href="http://www.idpf.org/epub/301/spec/epub-publications-20140626.html"/></para>
            </formalpara>
        </printhistory>
        <releaseinfo role="errata"><link xlink:href="./epub-spec-errata/">Errata</link></releaseinfo>
        <releaseinfo role="history"><link
                xlink:href="https://github.com/IDPF/epub-revision/commits/master/src/spec/epub-spec.xml">Changes to this
                document</link></releaseinfo>
        <releaseinfo role="formats">The complete EPUB 3.1 specification is also available for download as an <link
                xlink:href="http://www.idpf.org/epub/31/epub31.epub">EPUB Publication</link>.</releaseinfo>
        <xi:include href="./share/copyright.xml"/>
        <xi:include href="./share/legalnotice.xml"/>
        <authorgroup role="current">
            <editor>
                <personname>Markus Gylling</personname>
                <affiliation>
                    <org>
                        <orgname>International Digital Publishing Forum (IDPF)</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>Tzviya Siegman</personname>
                <affiliation>
                    <org>
                        <orgname>John Wiley &amp; Sons</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>Matt Garrish</personname>
                <affiliation>
                    <org>
                        <orgname>Invited Expert</orgname>
                    </org>
                </affiliation>
            </editor>
        </authorgroup>
        <abstract>
            <para>EPUB 3.1 is an interchange and delivery format for digital publications based on XML and Web
                Standards.</para>
        </abstract>
    </info>

    <xi:include href="share/status.xml"/>

    <chapter xml:id="sec-overview">
        <title>Overview</title>

        <section xml:id="sec-purpose-scope" conformance="informative">
            <title>Purpose and Scope</title>

            <para>This specification, EPUB 3.1, defines a distribution and interchange format standard for digital
                publications and documents. EPUB® defines a means of representing, packaging and encoding structured and
                semantically enhanced Web content — including HTML5, CSS, SVG and other resources — for distribution in a
                single-file format.</para>

            <para>EPUB has been widely adopted as the format for digital books (eBooks), and these specifications
                significantly increase the format's capabilities in order to better support a wider range of publication
                requirements, including complex layouts, rich media and interactivity, and global typography features. The
                expectation is that EPUB 3.1 will be utilized for a broad range of content, including books, magazines and
                educational, professional and scientific publications.</para>

            <para>EPUB 3.1 is modular in nature: it consists of a family of specifications that define the core features and
                functionality of the standard. This specification represents the primary entry point to standard, but the
                specifications listed in <xref linkend="sec-epub-specs"/> all belong the standard. An index to key concepts
                and definitions defined across these specifications is provided in <xref linkend="index"/>.</para>

            <para>The informative <xref linkend="refEPUB3Overview"/> provides a general introduction to the standard. A list
                of technical changes from EPUB 3.0.1, the previous version of the standard, is also available in the
                informative <xref linkend="refEPUB3Changes"/>.</para>
        </section>

        <section xml:id="sec-terminology">
            <title>Terminology</title>
            <xi:include href="./share/glossary.xml"/>
        </section>

        <xi:include href="./share/typography.xml"/>

        <xi:include href="./share/conformancestatements.xml"/>

        <xi:include href="./share/deprecated.xml"/>
    </chapter>

    <chapter xml:id="sec-epub-org">
        <title>Organization</title>

        <section xml:id="sec-epub-specs">
            <title>Specifications</title>

            <para>The EPUB 3.1 standard is modular in nature, with core features and functionality defined across a family of
                sub-specifications.</para>

            <para>This specification represents the top-most specification in the family. It includes the conformance
                requirements for both <link linkend="gloss-epub-publication">EPUB Publications</link>, the product of the
                standard, and <link linkend="gloss-epub-reading-system">EPUB Reading Systems</link>, the applications that
                consume EPUB Publications and present their content to <link linkend="gloss-user">Users</link> (see <xref
                    linkend="sec-epub-pub-conf"/> and <xref linkend="sec-epub-rs-conf"/>, respectively).</para>

            <para>The other specifications that comprise EPUB 3.1 are as follows:</para>

            <itemizedlist>
                <listitem>
                    <para><link xlink:href="epub-packages.html">EPUB Packages 3.1</link>
                        <xref linkend="refPackages3"/>, which defines the requirements for each <olink targetdoc="spec"
                            targetptr="gloss-rendition" type="epub-spec"/> of the content.</para>
                </listitem>
                <listitem>
                    <para><link xlink:href="epub-contentdocs.html">EPUB Content Documents 3.1</link>
                        <xref linkend="refContentDocs3"/>, which defines profiles of XHTML, SVG and CSS for use in the
                        context of EPUB Publications.</para>
                </listitem>
                <listitem>
                    <para><link xlink:href="epub-mediaoverlays.html">EPUB Media Overlays 3.1</link>
                        <xref linkend="refOverlays3"/>, which defines a format and a processing model for synchronization of
                        text and audio.</para>
                </listitem>
                <listitem>
                    <para><link xlink:href="epub-ocf.html">EPUB Open Container Format (OCF) 3.1</link>
                        <xref linkend="refOCF3"/>, which defines a file format and processing model for encapsulating a set
                        of related resources into a single-file (ZIP) <xref linkend="gloss-container"/>.</para>
                </listitem>
                <listitem>
                    <para><link xlink:href="../../linking/cfi/epub-cfi.html">EPUB Canonical Fragment Identifiers</link>
                        <xref linkend="refEPUBCFI"/>, which defines a standardized method for referencing arbitrary content
                        within an EPUB Publication through the use of fragment identifiers.</para>
                </listitem>
                <listitem>
                    <para><link xlink:href="../../altss-tags/altss-tags.html">Alternate Style Tags</link>
                        <xref linkend="refAlternateStyleTags"/>, which defines a pattern for tagging alternate style sheets
                        using microformats.</para>
                </listitem>
            </itemizedlist>

            <para>These specifications represent the formal list recognized as belonging to EPUB 3.1, and that contain
                functionality referenced as part of the standard, but new functionality is also added periodically through
                the development of extension specifications.</para>

            <annotation xml:id="issue-consolidation">
                <para>A number of recently completed modules and works in progress are under consideration for
                    consolidation/inclusion in the core standard. The consensus of the working group on the 2015-12-15
                    conference call was not to consider these modules at this time due to lack of proven implementations.
                    Their inclusion might, however, be reconsidered for a future draft. See <link
                        xlink:href="https://github.com/IDPF/epub-revision/issues/635">issue 635</link> in the tracker for the
                    list of modules.</para>
            </annotation>

            <para>Features and functionality defined outside of core revisions to the standard, while not formally recognized
                in this specification, are nonetheless available for use by <link linkend="gloss-author">Authors</link> and
                developers once they are recognized as <link
                    xlink:href="http://idpf.org/about_us/corp_docs/policies_and_procedures">Recommended
                Specifications</link>.</para>

            <note>
                <para>A list of current and recently-completed activities is maintained at <link
                        xlink:href="http://www.idpf.org/ongoing">http://www.idpf.org/ongoing</link>.</para>
            </note>
        </section>

        <section xml:id="sec-epub-roadmap" conformance="informative">
            <title>Roadmap</title>

            <annotation xml:id="issue-roadmap">
                <para>This roadmap was previously in the Overview, but was moved to the new top-level specification to give
                    more context. It may be returned to the Overview if it is not seen as helpful.</para>
                <para>The roadmap is outdated at this time. It will be updated in a later draft once the outcomes of the
                    revision stabilize.</para>
            </annotation>

            <para>The centerpiece of the EPUB standard is the <xref linkend="gloss-epub-publication"/>. This section provides
                a brief introduction to the different aspects that go into creating EPUB Publications. More information is
                available from the referenced specifications, and a more general introduction to the features of EPUB 3.1 is
                provided in the informative <xref linkend="refEPUB3Overview"/>.</para>

            <para>An EPUB Publication, at its most basic level, is a bundled collection of resources that can be reliably and
                predictably ingested by an <olink type="epub-spec" targetdoc="spec" targetptr="gloss-epub-reading-system"
                    >EPUB Reading System</olink> in order to render its contents to a <olink type="epub-spec"
                    targetdoc="spec" targetptr="gloss-user">User</olink>. Each EPUB Publication consists of one or renderings
                of its content, called <olink type="epub-spec" targetdoc="spec" targetptr="gloss-rendition"
                    >Renditions</olink>.</para>

            <para>Some of the resources in the EPUB Container facilitate the discovery and processing of the Renditions,
                while others make up the content of the source publication. The latter, <olink type="epub-spec"
                    targetdoc="spec" targetptr="gloss-content-document-epub">EPUB Content Documents</olink>, are defined in
                    <xref linkend="refContentDocs3"/>.</para>

            <para>An EPUB Publication's resources are typically bundled for distribution as a ZIP-based archive with the file
                extension <filename>.epub</filename>. As conformant ZIP archives, EPUB Publications can be unzipped by many
                software programs, simplifying both their production and consumption. The container format is defined in
                    <xref linkend="refOCF3"/>.</para>

            <para>The container format not only provides a means of determining that the zipped content represents an EPUB
                Publication (the <filename>mimetype</filename> file), but also provides a universally-named directory of
                informative resources (<filename>/META-INF</filename>). Key among these is the
                    <filename>container.xml</filename> file, which directs Reading Systems to the root files of the available
                Renditions of the EPUB Publication (their <olink type="epub-spec" targetdoc="spec"
                    targetptr="gloss-package-document">Package Documents</olink>).</para>

            <para>The Package Document is itself a kind of centralized information source for a given Rendition, storing
                metadata about the specific work expressed by the Rendition, providing an exhaustive list of resources and
                defining a default reading order. The Package Document is defined in <olink targetdoc="packages"
                    targetptr="sec-package-doc" type="epub-spec"/>.</para>

            <para><olink type="epub-spec" targetdoc="spec" targetptr="gloss-media-overlay-document">Media Overlay
                    Documents</olink> define a means of synchronizing text and audio playback for a given Rendition. The
                Overlay Document is defined in <xref linkend="refOverlays3"/>.</para>

            <para>The following example shows the resources a minimal single-Rendition "Hello World" EPUB Publication might
                contain:</para>

            <informalexample>
                <synopsis>
mimetype
META-INF/container.xml
Content/HelloWorld.opf
Content/HelloWorld.xhtml
</synopsis>
            </informalexample>

            <para>While conceptually simple, an EPUB Publication is more than just a collection of HTML pages and dependent
                assets in a ZIP package as represented in this example. The following sections of this document delve into
                more detail about the primary features and functionality that EPUB Publications provide to enhance the
                reading experience.</para>

        </section>
    </chapter>

    <chapter xml:id="sec-epub-conf">
        <title>Conformance</title>

        <section xml:id="sec-epub-pub-conf" xreflabel="EPUB Publication Conformance">
            <title>EPUB Publications</title>

            <para>An <olink targetdoc="spec" targetptr="gloss-epub-publication" type="epub-spec"/>
                <literal role="rfc2119">must</literal> meet all of the following criteria:</para>

            <variablelist role="conformance-list">
                <varlistentry xml:id="sec-epub-package-conformance">
                    <term>Packages</term>
                    <listitem>
                        <para xml:id="confreq-renditions">It <literal role="rfc2119">must</literal> include at least one
                                <olink targetdoc="spec" targetptr="gloss-rendition" type="epub-spec"/> of the content that
                            conforms to the requirements for <link linkend="gloss-epub-package">EPUB Packages</link> defined
                            in <xref linkend="refPackages3"/>.</para>
                    </listitem>
                </varlistentry>
                <varlistentry xml:id="sec-epub-pub-conformance-all">
                    <term>Publication Resources</term>
                    <listitem>
                        <para xml:id="confreq-manifest">All <olink targetdoc="spec"
                                targetptr="gloss-publication-resource-cmt-or-foreign" type="epub-spec">Publication
                                Resources</olink>
                            <literal role="rfc2119">must</literal> adhere to the <link linkend="sec-publication-resources"
                                >constraints for Core Media Types and Foreign Resources</link> and be located as per <xref
                                linkend="sec-resource-locations"/>.</para>
                    </listitem>
                </varlistentry>
                <varlistentry xml:id="sec-epub-pub-conformance-container">
                    <term>Container</term>
                    <listitem>
                        <para xml:id="confreq-ocf">It <literal role="rfc2119">must</literal> be packaged in a <olink
                                targetdoc="spec" targetptr="gloss-container" type="epub-spec"/> as defined in <xref
                                linkend="refOCF3"/>. </para>
                    </listitem>
                </varlistentry>
            </variablelist>

            <annotation xml:id="issue-bff">
                <para>The working group is currently considering an alternative unpackaged manifestation of an EPUB
                    Publication to standardize and simplify access to the contents by browser-based reading systems. This
                    manifestation will not replace by the Open Container Format, and it is expected that round-tripping
                    between the two will be possible. For more information, refer to the <link
                        xlink:href="https://docs.google.com/document/d/1nXd8xMsNOA7sdwudpO2KS_L0Hc-0SxYx1ScrGIhRBBg/edit"
                        >Server/Browser Friendly Manifestations document</link>.</para>
            </annotation>

        </section>

        <section xml:id="sec-epub-rs-conf" xreflabel="EPUB Reading System Conformance">
            <title>EPUB Reading Systems</title>

            <para>An <olink targetdoc="spec" targetptr="gloss-epub-reading-system" type="epub-spec"/>
                <literal role="rfc2119">must</literal> meet all of the following criteria:</para>

            <variablelist role="conformance-list">
                <varlistentry xml:id="sec-epub-rs-conf-epub3">
                    <term>EPUB 3.1 Processing</term>
                    <listitem>
                        <para xml:id="confreq-rs-epub3-ocf">It <literal role="rfc2119">must</literal> process the <olink
                                targetdoc="spec" targetptr="gloss-container" type="epub-spec"/> as defined in <xref
                                linkend="refOCF3"/>.</para>

                        <para xml:id="confreq-rs-epub3-package">It <literal role="rfc2119">must</literal> process <olink
                                targetdoc="spec" targetptr="gloss-epub-package" type="epub-spec">EPUB Packages</olink> as
                            defined in <xref linkend="refPackages3"/>.</para>

                        <para xml:id="confreq-rs-epub3-uid">It <literal role="rfc2119">must not</literal> fail
                            catastrophically if it encounters two distinct EPUB Packages with the same <olink
                                targetdoc="spec" targetptr="gloss-unique-identifier" type="epub-spec"/>. </para>

                        <para xml:id="confreq-rs-epub3-cmt">Unless specified as <phrase role="conditional">conditional
                                behavior</phrase> in this section, it <literal role="rfc2119">must</literal> support all
                                <olink targetdoc="spec" targetptr="gloss-publication-resource-cmt" type="epub-spec">Core
                                Media Type Resources</olink>.</para>

                        <para xml:id="confreq-rs-foreign">It <literal role="rfc2119">may</literal> support an arbitrary set
                            of <olink targetdoc="spec" targetptr="gloss-publication-resource-foreign" type="epub-spec"/>
                            types, and <literal role="rfc2119">must</literal> process fallbacks for unsupported Foreign
                            Resources as defined in <xref linkend="sec-foreign-restrictions"/> if not.</para>

                        <para xml:id="confreq-rs-epub3-xhtml">It <literal role="rfc2119">must</literal> process <olink
                                targetdoc="spec" targetptr="gloss-content-document-epub-html" type="epub-spec">HTML Content
                                Document</olink> as defined in <olink targetdoc="contentdocs" targetptr="sec-html-conf-rs"
                                type="epub-spec"/>.</para>

                        <para xml:id="confreq-rs-epub3-svg">It <literal role="rfc2119">must</literal> process <olink
                                targetdoc="spec" targetptr="gloss-content-document-epub-svg" type="epub-spec">SVG Content
                                Documents</olink> as defined in <olink targetdoc="contentdocs" targetptr="sec-svg-rs-conf"
                                type="epub-spec"/>.</para>

                        <para xml:id="confreq-rs-epub3-css"><phrase role="conditional">If it has a <olink targetdoc="spec"
                                    targetptr="gloss-viewport" type="epub-spec"/></phrase>, it <literal role="rfc2119"
                                >must</literal> support visual rendering of <olink targetdoc="spec"
                                targetptr="gloss-content-document-epub-html" type="epub-spec">HTML Content Documents</olink>
                            as defined in <olink targetdoc="contentdocs" targetptr="sec-css-rs-conf" type="epub-spec"
                            />.</para>

                        <para xml:id="confreq-rs-epub3-raster"><phrase role="conditional">If it has the capability to render
                                raster images</phrase>, it <literal role="rfc2119">must</literal> support the <link
                                linkend="cmt-grp-image">raster image Core Media Types</link>.</para>

                        <para xml:id="confreq-rs-epub3-vector"><phrase role="conditional">If it has the capability to render
                                vector images</phrase>, it <literal role="rfc2119">must</literal> support the <link
                                linkend="cmt-grp-image">vector image Core Media Types</link>.</para>

                        <para xml:id="confreq-rs-epub3-mp3-aac"><phrase role="conditional">If it has the capability to render
                                pre-recorded audio</phrase>, it <literal role="rfc2119">must</literal> support the <link
                                linkend="cmt-mp3">MP3 audio Core Media Type</link>, <literal role="rfc2119">should</literal>
                            support the <link linkend="cmt-mp4-aac">MP4 audio Core Media Type</link> and <literal
                                role="rfc2119">should</literal> support Media Overlays <xref linkend="refOverlays3"/>.</para>
                        <para xml:id="confreq-rs-epub3-tts"
                            xreflabel="Reading System Text-to-Speech Conformance Requirements"><phrase role="conditional">If
                                it supports <olink targetdoc="spec" targetptr="gloss-tts" type="epub-spec"/>
                                rendering</phrase>, it <literal role="rfc2119">should</literal> support <olink
                                targetdoc="contentdocs" targetptr="sec-pls" type="epub-spec"/>, the CSS3 Speech features of
                            the <olink targetdoc="contentdocs" targetptr="sec-css" type="epub-spec">EPUB CSS Profile</olink>
                            and <olink targetdoc="contentdocs" targetptr="sec-xhtml-ssml-attrib" type="epub-spec">SSML
                                attributes</olink> in <olink targetdoc="spec" targetptr="gloss-content-document-epub-html"
                                type="epub-spec">HTML Content Documents</olink>.</para>
                        <para xml:id="confreq-rs-cfi">It <literal role="rfc2119">must</literal> support the EPUB Canonical
                            Fragment Identifiers scheme <xref linkend="refEPUBCFI"/> for linking, and <literal role="rfc2119"
                                >may</literal> support additional linking schemes as defined in the <link
                                xlink:href="http://www.idpf.org/epub/linking/">EPUB Linking Scheme Registry</link>.</para>
                        <note xml:id="note-video-codecs">
                            <para>It is recommended that Reading Systems support at least one of the <xref linkend="refH264"
                                /> and <xref linkend="refVP8"/> video codecs, but this is not a conformance requirement: a
                                Reading System could support no video codecs at all. Authors and Reading System developers
                                need to take into consideration factors such as breadth of adoption, video playback quality,
                                and technology usage royalty requirements when making a choice to include or implement video
                                in either (or potentially, both) formats.</para>
                        </note>
                    </listitem>
                </varlistentry>
                <varlistentry xml:id="sec-epub-rs-conf-backward">
                    <term>Backward Compatibility</term>
                    <listitem>
                        <para xml:id="confreq-rs-backward-epub2">It <literal role="rfc2119">should</literal> process EPUB
                            version "<code role="value">2.0</code>" Publications as defined in <xref linkend="refOPF2"/>,
                                <xref linkend="refOPS2"/> and <xref linkend="refOCF2"/>.</para>
                        <para xml:id="confreq-rs-backward-epub3">It <literal role="rfc2119">should</literal> process EPUB
                            version "<code role="value">3.0</code>" Publications as defined in <xref
                                linkend="refPublications301"/>, <xref linkend="refContentDocs301"/> and <xref
                                linkend="refOCF301"/>.</para>
                        <para xml:id="confreq-rs-backward-epub">It <literal role="rfc2119">must</literal> attempt to process
                            any given Rendition of an EPUB Publication whose Package Document <markup>version</markup>
                            attribute designates a version lower than "<code role="value">3.1</code>" or which omits the
                                <markup>version</markup> attribute.</para>
                    </listitem>
                </varlistentry>
                <varlistentry xml:id="sec-epub-rs-conf-forward">
                    <term>Forward Compatibility</term>
                    <listitem>
                        <para xml:id="confreq-rs-forward-epubn">It <literal role="rfc2119">should</literal> attempt to
                            process any given Rendition of an EPUB Publication whose Package Document
                                <markup>version</markup> attribute designates a version higher than "<code role="value"
                                >3.1</code>".</para>
                    </listitem>
                </varlistentry>
                <varlistentry xml:id="sec-epub-rs-conf-xml">
                    <term>XML Processing</term>
                    <listitem>
                        <para xml:id="confreq-rs-xml-nval">It <literal role="rfc2119">must</literal> be a <link
                                xlink:href="http://www.w3.org/TR/xml/#proc-types">conformant non-validating processor</link>
                            <xref linkend="refXML"/>.</para>
                        <para xml:id="confreq-rs-xml-ns"> It <literal role="rfc2119">must</literal> be a <link
                                xlink:href="http://www.w3.org/TR/REC-xml-names/#ProcessorConformance">conformant
                                processor</link> as defined in <xref linkend="refXMLNamespaces"/>. </para>
                        <para xml:id="confreq-rs-xml-assocss">It <literal role="rfc2119">must</literal> support
                                <markup>xml-stylesheet</markup> processing instructions <xref linkend="refXMLStylesheets"/>,
                            and <literal role="rfc2119">may</literal> support additional processing instructions.</para>

                        <para xml:id="confreq-rs-xml-base">It <literal role="rfc2119">must</literal> be a conformant
                            application as defined by <xref linkend="refXMLBase"/>.</para>
                    </listitem>
                </varlistentry>

            </variablelist>

            <note>
                <para>A conforming Reading System is not necessarily a single dedicated program or device, but may exist as a
                    distributed system.</para>
            </note>

        </section>
    </chapter>

    <chapter xml:id="sec-publication-resources">
        <title>Publication Resources</title>

        <section xml:id="sec-core-media-types">
            <title>Core Media Types</title>

            <section xml:id="sec-cmt-intro">
                <title>Introduction</title>

                <para>Each <olink targetdoc="spec" targetptr="gloss-rendition" type="epub-spec">Rendition</olink> of an
                        <olink targetdoc="spec" targetptr="gloss-epub-publication" type="epub-spec"/> typically consists of
                    many <olink targetdoc="spec" targetptr="gloss-publication-resource-cmt-or-foreign" type="epub-spec"
                        >Publication Resources</olink>. These resources are divided into two categories: those that <olink
                        targetdoc="spec" targetptr="gloss-epub-reading-system" type="epub-spec">EPUB Reading Systems</olink>
                    are required to support (<olink targetdoc="spec" targetptr="gloss-publication-resource-cmt"
                        type="epub-spec">Core Media Type Resources</olink>) and those that they are not (<olink
                        targetdoc="spec" targetptr="gloss-publication-resource-foreign" type="epub-spec">Foreign
                        Resources</olink>).</para>

                <para><olink targetdoc="spec" targetptr="gloss-author" type="epub-spec">Authors</olink> are free to use both
                    types of resources to construct their EPUB Publications, but need to be aware that some Reading Systems
                    might not render the Foreign Resources they use.</para>

                <para>As EPUB Publications are designed to be fully consumable on any compliant Reading System, a system of
                    fallbacks is therefore necessary to ensure that the use of Foreign Resources does not impact on the
                    ability of the <link linkend="gloss-user">User</link> to consume the content. This section lays out the
                        <link linkend="sec-cmt-supported">set of Core Media Types</link> that are supported across Reading
                    Systems and identifies <link linkend="sec-foreign-restrictions">fallback mechanisms</link> that can be
                    used to satisfy the consumability requirement.</para>
            </section>

            <section xml:id="sec-cmt-supported">
                <title>Supported Media Types</title>

                <annotation xml:id="issue-opus">
                    <para>The working group is currently considering adding the Opus audio codec as a core media type. See
                            <link xlink:href="https://github.com/IDPF/epub-revision/issues/645">issue #645</link> for more
                        information.</para>
                </annotation>

                <para>The following table lists the EPUB 3.1 <xref linkend="gloss-core-media-type"/>. When a <olink
                        targetdoc="spec" targetptr="gloss-publication-resource-cmt-or-foreign" type="epub-spec"/> conforms to
                    a Core Media Type specification, it is a <olink targetdoc="spec"
                        targetptr="gloss-publication-resource-cmt" type="epub-spec"/> and can be included in the EPUB
                    Publication without the provision of fallbacks (refer to <xref linkend="sec-foreign-restrictions"/> for
                    more information).</para>

                <para>The columns in the table represent the following information:</para>
                <variablelist xml:id="tbl-cmt-expl">
                    <varlistentry>
                        <term>Media Type</term>
                        <listitem>
                            <para>The MIME media type <xref linkend="refRFC2046"/> used to represent the given Publication
                                Resource in the <olink targetdoc="packages" targetptr="sec-manifest-elem" type="epub-spec"/>.
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Content Type Definition</term>
                        <listitem>
                            <para>The specification to which the given <olink targetdoc="spec"
                                    targetptr="gloss-publication-resource-cmt" type="epub-spec"/>
                                <literal role="rfc2119">must</literal> conform.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Applies to</term>
                        <listitem>
                            <para>The Publication Resource type(s) that the Media Type and Content Type Definition applies
                                to.</para>
                        </listitem>
                    </varlistentry>
                </variablelist>

                <table xml:id="tbl-core-media-types" xreflabel="EPUB Core Media Types">
                    <caption>EPUB Core Media Types</caption>
                    <thead>
                        <tr>
                            <th xml:id="tbl-cmt-string">Media Type</th>
                            <th xml:id="tbl-cmt-def">Content Type Definition</th>
                            <th xml:id="tbl-cmt-appl">Applies to</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th xml:id="cmt-grp-image" xreflabel="Image Core Media Types" colspan="3"> Image Types </th>
                        </tr>
                        <tr>
                            <td xml:id="cmt-gif" xreflabel="image/gif">
                                <code role="media-type">image/gif</code>
                            </td>
                            <td>
                                <xref linkend="refGIF"/>
                            </td>
                            <td>GIF Images</td>
                        </tr>

                        <tr>
                            <td xml:id="cmt-jpeg" xreflabel="image/jpeg">
                                <code role="media-type">image/jpeg</code>
                            </td>
                            <td>
                                <xref linkend="refJPEG"/>
                            </td>
                            <td>JPEG Images</td>
                        </tr>

                        <tr>
                            <td xml:id="cmt-png" xreflabel="image/png">
                                <code role="media-type">image/png</code>
                            </td>
                            <td>
                                <xref linkend="refPNG"/>
                            </td>
                            <td>PNG Images</td>
                        </tr>
                        <tr>
                            <td xml:id="cmt-svg11" xreflabel="image/svg+xml">
                                <code role="media-type">image/svg+xml</code>
                            </td>
                            <td>
                                <olink targetdoc="contentdocs" targetptr="sec-svg" type="epub-spec"/>
                            </td>
                            <td>SVG documents</td>
                        </tr>

                        <tr>
                            <th xml:id="cmt-grp-content-documents" xreflabel="Application Core Media Types" colspan="3">
                                Application Types </th>
                        </tr>

                        <tr>
                            <td xml:id="cmt-xhtml" xreflabel="application/xhtml+xml">
                                <code role="media-type">application/xhtml+xml</code>
                            </td>
                            <td>
                                <olink targetdoc="contentdocs" targetptr="sec-html" type="epub-spec"/>
                            </td>
                            <td><olink targetdoc="spec" targetptr="gloss-content-document-epub-html" type="epub-spec">HTML
                                    Content Documents</olink> that use the <link
                                    xlink:href="http://www.w3.org/TR/html5/the-xhtml-syntax.html#the-xhtml-syntax">XHTML
                                    syntax</link>
                                <xref linkend="refHTML5"/>. </td>
                        </tr>
                        <tr>
                            <td xml:id="cmt-sfnt" xreflabel="application/font-sfnt">
                                <code role="media-type">application/font-sfnt</code>
                            </td>
                            <td>
                                <xref linkend="refOpenType"/>
                                <xref linkend="refTrueType"/>
                            </td>
                            <td>OpenType and TrueType fonts</td>
                        </tr>
                        <tr>
                            <td xml:id="cmt-woff" xreflabel="application/font-woff">
                                <code role="media-type">application/font-woff</code>
                            </td>
                            <td>
                                <xref linkend="refWOFF"/>
                            </td>
                            <td>WOFF fonts</td>
                        </tr>
                        <tr>
                            <td xml:id="cmt-smil" xreflabel="application/smil+xml">
                                <code role="media-type">application/smil+xml</code>
                            </td>
                            <td>
                                <xref linkend="refOverlays3"/>
                            </td>
                            <td>EPUB Media Overlay documents</td>
                        </tr>
                        <tr>
                            <td xml:id="cmt-pls" xreflabel="application/pls+xml">
                                <code role="media-type">application/pls+xml</code>
                            </td>
                            <td>
                                <xref linkend="refPLS"/>
                            </td>
                            <td><olink targetdoc="spec" targetptr="gloss-tts" type="epub-spec"/> Pronunciation lexicons</td>
                        </tr>
                        <tr>
                            <th xml:id="cmt-grp-audio" xreflabel="Audio Core Media Types" colspan="3"> Audio Types </th>
                        </tr>
                        <tr>
                            <td xml:id="cmt-mp3" xreflabel="audio/mpeg">
                                <code role="media-type">audio/mpeg</code></td>
                            <td>
                                <xref linkend="refMP3"/>
                            </td>
                            <td>MP3 audio</td>
                        </tr>
                        <tr>
                            <td xml:id="cmt-mp4-aac" xreflabel="audio/aac">
                                <code role="media-type">audio/mp4</code>
                            </td>
                            <td>
                                <xref linkend="refAAC"/>, <xref linkend="refMP4"/>
                            </td>
                            <td>AAC LC audio using MP4 container</td>
                        </tr>
                        <tr>
                            <th xml:id="cmt-grp-video" xreflabel="Video Core Media Types" colspan="3"> Video Types </th>
                        </tr>
                        <tr>
                            <td xml:id="cmt-vide-note" colspan="3">This specification does not currently define any video
                                codecs as Core Media Types. Refer to the <link linkend="note-video-codecs">note in Reading
                                    System Conformance</link> above for informative recommendations on support for video
                                codecs in EPUB Publications. </td>
                        </tr>
                        <tr>
                            <th xml:id="cmt-grp-text" xreflabel="Text Core Media Types" colspan="3"> Text Types </th>
                        </tr>
                        <tr>
                            <td xml:id="cmt-html" xreflabel="text/html">
                                <code role="media-type">text/html</code>
                            </td>
                            <td>
                                <olink targetdoc="contentdocs" targetptr="sec-html" type="epub-spec"/>
                            </td>
                            <td><olink targetdoc="spec" targetptr="gloss-content-document-epub-html" type="epub-spec">HTML
                                    Content Documents</olink> that use the <link
                                    xlink:href="http://www.w3.org/TR/html5/syntax.html#syntax">HTML syntax</link>
                                <xref linkend="refHTML5"/>. </td>
                        </tr>
                        <tr>
                            <td xml:id="cmt-css" xreflabel="text/css">
                                <code role="media-type">text/css</code>
                            </td>
                            <td>
                                <olink targetdoc="contentdocs" targetptr="sec-css" type="epub-spec"/>
                            </td>
                            <td>CSS Style Sheets. </td>
                        </tr>
                        <tr>
                            <td xml:id="cmt-js" xreflabel="javascript">
                                <code role="media-type">text/javascript</code>
                            </td>
                            <td>
                                <xref linkend="refRFC4329"/>
                            </td>
                            <td>Scripts</td>
                        </tr>
                        <tr>
                            <th xml:id="cmt-grp-font" xreflabel="Font Core Media Types" colspan="3"> Font Types </th>
                        </tr>
                        <tr>
                            <td xml:id="cmt-woff2" xreflabel="font/woff2">
                                <code role="media-type">font/woff2</code>
                            </td>
                            <td>
                                <xref linkend="refWOFF2"/>
                            </td>
                            <td>WOFF2 fonts</td>
                        </tr>
                    </tbody>
                </table>
                <note>
                    <para>The <code role="media-type" linkend="cmt-sfnt">application/font-sfnt</code> media type <link
                            linkend="sec-overview-deprecated">supersedes</link>
                        <code role="media-type">application/vnd.ms-opentype</code>.</para>
                </note>
            </section>

            <section xml:id="sec-foreign-restrictions">
                <title>Foreign Resources</title>
                <para xml:id="confreq-foreign-no-fallback">Foreign Resources <literal role="rfc2119">may</literal> be
                    included in a Rendition without a fallback provided they are not referenced from <olink
                        targetdoc="packages" targetptr="sec-itemref-elem" type="epub-spec">spine itemref elements</olink> or
                    directly rendered in their native format in EPUB Content Documents (e.g., via <xref linkend="refHTML5"/>
                    <link xlink:href="http://www.w3.org/TR/html5/dom.html#embedded-content">embedded content</link> and <xref
                        linkend="refSVG"/>
                    <markup xlink:href="http://www.w3.org/TR/SVG/struct.html#ImageElement">image</markup> and <markup
                        xlink:href="http://www.w3.org/TR/SVG/extend.html#ForeignObjectElement">foreignObject</markup>
                    elements).</para>

                <para xml:id="confreq-cmt">When a <olink targetdoc="spec" targetptr="gloss-publication-resource-foreign"
                        type="epub-spec">Foreign Resource</olink> is included in the spine or directly rendered in its native
                    format in an EPUB Content Document, a Core Media Type fallback <literal role="rfc2119">must</literal> be
                    included. Fallbacks take one of the two following forms:</para>

                <itemizedlist>
                    <listitem>
                        <para>intrinsic fallback mechanisms provided by the format (e.g., ability to provide more than one
                            media type or to display an alternate embedded message when a media type cannot be rendered).
                            Refer to the <xref linkend="refHTML5"/> and <xref linkend="refSVG"/> specifications for the
                            intrinsic fallback capabilities their elements provide.</para>
                    </listitem>
                    <listitem>
                        <para><olink targetdoc="packages" targetptr="sec-foreign-restrictions-manifest" type="epub-spec"
                                >manifest fallbacks</olink> are a feature of the <olink targetdoc="spec"
                                targetptr="gloss-package-document" type="epub-spec"/> that create a fallback chain to a Core
                            Media Type Resources. They are used to create fallbacks for Foreign Resources in the <olink
                                targetdoc="packages" targetptr="sec-spine-elem" type="epub-spec"/> and when intrinsic
                            fallback capabilities are not available (e.g., for the <xref linkend="refHTML5"/>
                            <markup xlink:href="http://www.w3.org/TR/html5/embedded-content-0.html#the-img-element"
                                >img</markup> element).</para>
                    </listitem>
                </itemizedlist>

                <para>In the case of a Foreign Resource that serves as an input to a script, the script <literal
                        role="rfc2119">should</literal> use the data such that it is presented as a Core Media Type (e.g.,
                    used to draw in an <xref linkend="refHTML5"/>
                    <link xlink:href="https://www.w3.org/TR/html5/scripting-1.html#the-canvas-element"
                            ><markup>canvas</markup> element</link> or injected into the HTML or SVG DOM as native markup);
                    otherwise, the script <literal role="rfc2119">must</literal> include a Core Media Type fallback (e.g., if
                    writing the data to an <xref linkend="refHTML5"/>
                    <literal xlink:href="https://www.w3.org/TR/html5/dom.html#embedded-content-2">embedded content
                        element</literal>, include an intrinsic fallback alternative).</para>
            </section>
        </section>

        <section xml:id="sec-resource-locations" xreflabel="Publication Resource Locations">
            <title>Resource Locations</title>

            <para>All <olink targetdoc="spec" targetptr="gloss-publication-resource-cmt-or-foreign" type="epub-spec"
                    >Publication Resources</olink>
                <literal role="rfc2119">must</literal> be located in the <olink targetdoc="spec" targetptr="gloss-container"
                    type="epub-spec"/>, with the following exceptions:</para>

            <itemizedlist role="conformance-list">
                <listitem xml:id="sec-resource-locations-audio">
                    <para><link linkend="cmt-grp-audio">Audio resources</link>
                        <literal role="rfc2119">may</literal> be located in the Container or remotely.</para>
                </listitem>
                <listitem xml:id="sec-resource-locations-video">
                    <para>Video resources <literal role="rfc2119">may</literal> be located in the Container or
                        remotely.</para>
                </listitem>
            </itemizedlist>

            <annotation xml:id="issue-res-locations">
                <para>The working group is currently considering whether other resources, such as fonts and data sets, can be
                    hosted outside the container, as well as whether resources within the container can be marked as
                    available for download by users. For more information, refer to the <link
                        xlink:href="https://docs.google.com/document/d/1twG3TLzn9tA_r4DjH_Q2f7Hn5qs1sKsIPgGEB9vxKMg/edit"
                        >External Resources document</link>.</para>
            </annotation>

            <para>Authors <literal role="rfc2119">should</literal> prefer locating audio and video resources in the Container
                to allow the user access to the entire presentation regardless of connectivity status.</para>

            <note>
                <para>The above rules for Publication Resource locations apply regardless of whether the given resource is a
                        <olink targetdoc="spec" targetptr="gloss-publication-resource-cmt" type="epub-spec"/> or a <olink
                        targetdoc="spec" targetptr="gloss-publication-resource-foreign" type="epub-spec"/>.</para>
            </note>

            <note>
                <para>The inclusion of remote resources in an <olink targetdoc="spec" targetptr="gloss-epub-publication"
                        type="epub-spec"/> is indicated via the <link
                        xlink:href="../../vocab/package/epub-vocab-package.html#remote-resources"
                            ><property>remote-resources</property> property</link>
                    <xref linkend="refEPUBPackageVocab"/> on the <olink targetdoc="spec" targetptr="gloss-manifest"
                        type="epub-spec"/>
                    <markup><olink targetdoc="packages" targetptr="sec-item-elem" type="epub-spec"/></markup> element.</para>
            </note>

        </section>

        <section xml:id="sec-xml-constraints">
            <title>XML Conformance</title>

            <para>Any <olink targetdoc="spec" targetptr="gloss-publication-resource-cmt-or-foreign" type="epub-spec"/> that
                is an XML-Based Media Type <literal role="rfc2119">must</literal> meet the following constraints:</para>

            <itemizedlist role="conformance-list">
                <listitem>
                    <para xml:id="confreq-xml-wellformed"> It <literal role="rfc2119">must</literal> be a conformant XML 1.0
                        Document as defined in <link xlink:href="http://www.w3.org/TR/REC-xml-names/#Conformance">Conformance
                            of Documents</link>
                        <xref linkend="refXMLNamespaces"/>.
                        <!-- It <literal role="rfc2119">must</literal> be
                            a <link xlink:href="http://www.w3.org/TR/xml/#sec-well-formed">well-formed XML Document</link>
                            <xref linkend="refXML"/>.-->
                    </para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-xml-extmarkupdecl">
                        <link xlink:href="http://www.w3.org/TR/2008/PER-xml-20080205/#NT-ExternalID">External
                            identifiers</link>
                        <literal role="rfc2119">must not</literal> appear in the document type declaration <xref
                            linkend="refXML"/>. </para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-xml-xinc"> It <literal role="rfc2119">must not</literal> make use of XInclude <xref
                            linkend="refXInclude"/>.
                        <!-- note: troublesome to say "include elements in the xinclude namespace" in this case, since xinclude happens in a pre stage -->
                    </para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-xml-enc">
                        <phrase xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">It <literal
                                role="rfc2119">must</literal> be encoded in UTF-8 or UTF-16 <xref linkend="refUnicode5"
                            />.</phrase>
                    </para>
                </listitem>
            </itemizedlist>

            <para>The above constraints apply regardless of whether the given Publication Resource is a <olink
                    targetdoc="spec" targetptr="gloss-publication-resource-cmt" type="epub-spec"/> or a <olink
                    targetdoc="spec" targetptr="gloss-publication-resource-foreign" type="epub-spec"/>. </para>

        </section>
    </chapter>

    <xi:include href="./share/index.xml"/>

    <xi:include href="./share/contributors.xml"/>

    <xi:include href="./share/references.xml"/>
</book>
