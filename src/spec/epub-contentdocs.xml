<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="../../util/docbook/schema/docbookspec.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
<?xml-model href="../../util/docbook/schema/docbookspec.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<?xml-model href="../../util/docbook/schema/docbook.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<book xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:xi="http://www.w3.org/2001/XInclude" version="5.1" xmlns:epub="http://www.idpf.org/2011/epub"
    xmlns:spec="http://www.idpf.org/2016/epub/spec" xml:lang="en">
    <title>EPUB Content Documents 3.1</title>

    <info>
        <releaseinfo>Editor's Draft</releaseinfo>
        <pubdate>1 August 2016</pubdate>
        <printhistory>
            <formalpara>
                <title>This version</title>
                <para><link xlink:href="http://www.idpf.org/epub/31/spec/epub-contentdocs-20160801.html"/></para>
            </formalpara>
            <formalpara>
                <title>Latest version</title>
                <para><link xlink:href="http://www.idpf.org/epub3/latest/contentdocs"/></para>
            </formalpara>
            <formalpara>
                <title>Previous version</title>
                <para><link xlink:href="http://www.idpf.org/epub/301/spec/epub-contentdocs-20160426.html"/></para>
            </formalpara>
            <formalpara>
                <title>Previous recommendation</title>
                <para><link xlink:href="http://www.idpf.org/epub/301/spec/epub-contentdocs-20140626.html"/></para>
            </formalpara>
        </printhistory>
        <releaseinfo role="issues"><link
                xlink:href="https://github.com/IDPF/epub-revision/issues?q=milestone%3A%22EPUB+3.1%22+is%3Aclosed+label%3ASpec-ContentDocs"
                >Issues addressed in this revision</link></releaseinfo>
        <releaseinfo role="errata"><link xlink:href="./epub-contentdocs-errata/">Errata</link></releaseinfo>
        <releaseinfo role="history"><link
                xlink:href="https://github.com/IDPF/epub-revision/commits/master/src/spec/epub-contentdocs.xml">Changes to
                this document</link></releaseinfo>
        <releaseinfo role="formats">The complete EPUB 3.1 specification is also available for download as an <link
                xlink:href="http://www.idpf.org/epub/31/epub31.epub">EPUB Publication</link>.</releaseinfo>
        <xi:include href="./share/copyright.xml"/>
        <xi:include href="./share/legalnotice.xml"/>
        <authorgroup role="current">
            <editor>
                <personname>Markus Gylling</personname>
                <affiliation>
                    <org>
                        <orgname>International Digital Publishing Forum (IDPF)</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>William McCoy</personname>
                <affiliation>
                    <org>
                        <orgname>International Digital Publishing Forum (IDPF)</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>Dave Cramer</personname>
                <affiliation>
                    <org>
                        <orgname>Hachette Book Group</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>Elika J. Etemad</personname>
                <affiliation>
                    <org>
                        <orgname>Invited Expert</orgname>
                    </org>
                </affiliation>
            </editor>
            <editor>
                <personname>Matt Garrish</personname>
                <affiliation>
                    <org>
                        <orgname>Invited Expert</orgname>
                    </org>
                </affiliation>
            </editor>
        </authorgroup>
        <abstract>
            <title>EPUB Content Documents 3.1</title>
            <para>EPUB Content Documents 3.1 specifies a usage of HTML, SVG and CSS optimized for representation of
                structured, composable, and accessible documents.</para>
        </abstract>
    </info>

    <xi:include href="share/status.xml"/>

    <chapter xml:id="sec-overview">
        <title>Overview</title>

        <section xml:id="sec-overview-purpose-and-scope" conformance="informative">
            <title>Purpose and Scope</title>

            <para>This specification, EPUB Content Documents 3.1, defines profiles of HTML, SVG, and CSS for use in the
                context of <olink targetdoc="spec" targetptr="gloss-epub-publication" type="epub-spec">EPUBÂ®
                    Publications</olink>.</para>

            <xi:include href="share/specdesc-all.xml"/>

            <para>Refer to <xref linkend="refEPUB3Changes"/> for more information on the differences between this
                specification and its predecessor.</para>

        </section>

        <section xml:id="sec-overview-relations" conformance="informative">

            <title>Relationship to Other Specifications</title>

            <section xml:id="sec-overview-relations-html">
                <title>Relationship to HTML</title>

                <para>This specification does not reference a specific version of W3C <xref linkend="refHTML"/>, but instead
                    uses an undated reference that will always point to the latest recommendation. This approach ensures that
                    EPUB will always keep pace with changes to the HTML standard. Authors and Reading System developers will
                    need to keep track of changes to HTML, and ensure that their processes and systems are kept up to
                    date.</para>

                <caution>
                    <para>As HTML evolves, it is possible that features that were valid in previous versions could become
                        obsolete or be removed. IDPF anticipates that the W3C will make any such changes carefully to ensure
                        minimal disruption for Authors, but in the case of a backwards-incompatible revision the use of an
                        undated reference could be revisited.</para>
                </caution>

                <para>The <link linkend="sec-xhtml">XHTML document type defined by this specification</link> inherits all
                    definitions of semantics, structure and processing behaviors from <xref linkend="refHTML"/> unless
                    otherwise specified.</para>

                <para>In addition, this specification <link linkend="sec-xhtml-extensions">defines a set of extensions</link>
                    to the W3C HTML document model that <olink targetdoc="spec" targetptr="gloss-author" type="epub-spec"
                        epub:specref-exclude="true">Authors</olink> can include in <olink targetdoc="spec"
                        targetptr="gloss-content-document-epub-xhtml" type="epub-spec" epub:specref-exclude="true">XHTML
                        Content Documents</olink>.</para>

                <para>This specification defines a simplified processing model that does not require <olink targetdoc="spec"
                        targetptr="gloss-epub-reading-system" type="epub-spec">EPUB Reading Systems</olink> to support
                    scripting, HTML forms or the HTML DOM. Reading Systems conformant with this specification are only
                    expected to be able to process a conforming <olink targetdoc="spec"
                        targetptr="gloss-content-document-epub" type="epub-spec"/>. As <link
                        linkend="sec-scripted-content-rs-reqs">support for scripting and HTML forms</link> is not compulsory,
                    a conformant Reading System might not be a fully-conformant HTML User Agent (i.e., it might not implement
                    the complete HTML processing model).</para>
            </section>

            <section xml:id="sec-overview-relations-svg">
                <title>Relationship to SVG</title>

                <para>This specification does not reference a specific version of <xref linkend="refSVG"/>, but instead uses
                    an undated reference that will always point to the latest recommendation. This approach ensures that EPUB
                    will always keep pace with changes to the SVG standard. Authors and Reading System developers will need
                    to keep track of changes to the SVG standard, and ensure that their processes and systems are kept up to
                    date.</para>

                <caution>
                    <para>As SVG evolves, it is possible that features that were valid in previous versions could become
                        obsolete or be removed. IDPF anticipates that the W3C will make any such changes carefully to ensure
                        minimal disruption for Authors, but in the case of a backwards-incompatible revision the use of an
                        undated reference could be revisited.</para>
                </caution>

                <para>This specification defines <link linkend="sec-svg">a restricted subset of SVG</link> to represent
                    vector graphics inline in <olink targetdoc="spec" targetptr="gloss-content-document-epub-xhtml"
                        type="epub-spec">XHTML Content Documents</olink> and as standalone <olink targetdoc="spec"
                        targetptr="gloss-content-document-epub-svg" type="epub-spec">SVG Content Documents</olink>. </para>
            </section>

            <section xml:id="sec-overview-relations-css">
                <title>Relationship to CSS</title>
                <para>EPUB 3.1 supports CSS as defined by the CSS Working Group Snapshot <xref linkend="refCSSSNAP"/>, based
                    on CSS 2.1 <xref linkend="refCSS21"/> plus many newer modules. EPUB 3.1 also maintains some prefixed CSS
                    properties, to ensure consistent support for global languages.</para>
            </section>
        </section>

        <xi:include href="./share/terminology.xml"/>

        <xi:include href="./share/typography.xml"/>

        <xi:include href="./share/conformancestatements.xml"/>

        <section xml:id="sec-overview-pfx">
            <title>Namespace prefix mapping</title>

            <para>For convenience, the following namespace prefixes <xref linkend="refXMLNamespaces"/> are used in this
                specification without explicitly being declared. To use any of these prefixes in an <olink targetdoc="spec"
                    targetptr="gloss-content-document-epub" type="epub-spec"/>, a declaration is <literal role="rfc2119"
                    >required</literal>.</para>

            <table xml:id="tbl-nspfx">
                <caption>Prefix mappings</caption>
                <tr>
                    <th class="left">prefix</th>
                    <th class="odd">URI</th>
                </tr>
                <tr>
                    <td class="left">
                        <markup>epub</markup>
                    </td>
                    <td class="odd">
                        <uri>http://www.idpf.org/2007/ops</uri>
                    </td>
                </tr>
                <tr>
                    <td class="left">
                        <markup>pls</markup>
                    </td>
                    <td class="odd">
                        <uri>https://www.w3.org/2005/01/pronunciation-lexicon</uri>
                    </td>
                </tr>
                <tr>
                    <td class="left">
                        <markup>ssml</markup>
                    </td>
                    <td class="odd">
                        <uri>https://www.w3.org/2001/10/synthesis</uri>
                    </td>
                </tr>
            </table>
        </section>
    </chapter>

    <chapter xml:id="sec-xhtml">
        <title>XHTML Content Documents</title>

        <section xml:id="sec-xhtml-intro">
            <title>Introduction</title>

            <para>This section defines a profile of <xref linkend="refHTML"/> for creating XHTML Content Documents. An
                instance of an XML document that conforms to this profile is a <olink targetdoc="spec"
                    targetptr="gloss-publication-resource-cmt" type="epub-spec"/> and is referred to in this specification as
                an <olink targetdoc="spec" targetptr="gloss-content-document-epub-xhtml" type="epub-spec"/>.</para>

            <para>Unless otherwise specified, this specification inherits all definitions of semantics, structure and
                processing behaviors from the <xref linkend="refHTML"/> specification. </para>
        </section>

        <section xml:id="sec-xhtml-conf-content" xreflabel="XHTML Content Documents â Content Conformance">
            <title>Content Conformance</title>
            <para>An <olink targetdoc="spec" targetptr="gloss-content-document-epub-xhtml" type="epub-spec"/>
                <literal role="rfc2119">must</literal> meet all of the following criteria:</para>
            <variablelist role="conformance-list" xml:id="confreq-cd-html">
                <varlistentry xml:id="confreq-cd-html-docprops">
                    <term>Document Properties</term>
                    <listitem>
                        <para xml:id="confreq-cd-html-docprops-syntax">It <literal role="rfc2119">must</literal> be an <xref
                                linkend="refHTML"/> document that conforms to the <link
                                xlink:href="https://www.w3.org/TR/html/xhtml.html#xhtml">XHTML</link> syntax.</para>

                        <para xml:id="confreq-cd-html-xml">It <literal role="rfc2119">must</literal> meet the conformance
                            constraints for XML documents defined in <olink epub:spec-include="default" type="epub-spec"
                                targetdoc="spec" targetptr="sec-xml-constraints"/>. </para>

                        <para xml:id="confreq-cd-html-docprops-html">For all document constructs used that are defined by
                                <xref linkend="refHTML"/>, it <literal role="rfc2119">must</literal> conform to the
                            conformance criteria defined for those constructs in that specification, unless explicitly
                            overridden in <xref linkend="sec-xhtml-deviations"/>.</para>

                        <para xml:id="confreq-cd-html-docprops-schema">It <literal role="rfc2119">may</literal> include
                            extensions to the <xref linkend="refHTML"/> grammar as defined in <xref
                                linkend="sec-xhtml-extensions"/>, and <literal role="rfc2119">must</literal> conform to all
                            content conformance constraints defined therein. </para>

                        <note>
                            <para>The recommendation that EPUB Publications follow the accessibility requirements in <xref
                                    linkend="refA11Y"/> applies to XHTML Content Documents. See <olink targetdoc="spec"
                                    targetptr="sec-epub-a11y" type="epub-spec"/>.</para>
                        </note>
                    </listitem>
                </varlistentry>
                <varlistentry xml:id="confreq-cd-html-fileprops">
                    <term>File Properties</term>
                    <listitem>
                        <para xml:id="confreq-cd-xhtml-fileprops-name">The XHTML Content Document filename <literal
                                role="rfc2119">should</literal> use the file extension <filename>.xhtml</filename></para>
                    </listitem>
                </varlistentry>
            </variablelist>
        </section>

        <section xml:id="sec-xhtml-conf-rs" xreflabel="XHTML Content Documents â Reading System Conformance">
            <title>Reading System Conformance</title>

            <para>A conformant <olink targetdoc="spec" targetptr="gloss-epub-reading-system" type="epub-spec"/>
                <literal role="rfc2119">must</literal> meet all of the following criteria for processing <olink
                    targetdoc="spec" targetptr="gloss-content-document-epub-xhtml" type="epub-spec">XHTML Content
                    Documents</olink>:</para>

            <itemizedlist role="conformance-list" xml:id="html-rs-confreqs">
                <listitem>
                    <!-- todo below: overridden really refers to the deviations and extensions sections-->
                    <para xml:id="confreq-html-rs-behavior">Unless explicitly defined by this specification as overridden, it
                            <literal role="rfc2119">must</literal> process XHTML Content Documents using semantics defined by
                        the <xref linkend="refHTML"/> specification and honor any applicable User Agent conformance
                        constraints expressed therein.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-html-rs-behavior-add">It <literal role="rfc2119">must</literal> meet all Reading
                        System conformance criteria defined in <xref linkend="sec-xhtml-extensions"/>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-html-rs-behavior-restr">It <literal role="rfc2119">must</literal> recognize and
                        adapt behaviorally to the constraints defined in <xref linkend="sec-xhtml-deviations"/>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-html-rs-scrpt">It <literal role="rfc2119">must</literal> meet the Reading System
                        conformance criteria defined in <xref linkend="sec-scripted-content-rs-reqs"/>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-html-rs-css">It <literal role="rfc2119">must</literal> support visual rendering of
                        XHTML Content Documents as defined in <xref linkend="sec-css-rs-conf"/>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-html-rs-a11y">It <literal role="rfc2119">should</literal> recognize embedded ARIA
                        markup and support exposure of any given ARIA roles, states and properties to platform accessibility
                        APIs <xref linkend="refARIA"/>. </para>
                </listitem>
            </itemizedlist>
        </section>

        <section xml:id="sec-xhtml-extensions">
            <title>HTML Extensions</title>

            <para>This section defines EPUB 3.1 <olink targetdoc="spec" targetptr="gloss-content-document-epub-xhtml"
                    type="epub-spec"/> extensions to the underlying <xref linkend="refHTML"/> document model.</para>

            <note>
                <para>Although <xref linkend="refHTML"/> allows user agents to support <link
                        xlink:href="https://www.w3.org/TR/html5/infrastructure.html#extensibility-0">vendor-neutral
                        extensions</link>, unless such extensions are listed in this section they are not supported features
                    of EPUB 3.1.</para>
            </note>

            <section xml:id="sec-xhtml-semantic-inflection" xreflabel="XHTML Semantic Inflection">
                <title>Semantic Inflection</title>

                <section xml:id="sec-xhtml-semantic-inflection-intro" conformance="informative">
                    <title>Introduction</title>

                    <para>Semantic inflection is the process of attaching additional meaning about the specific purpose
                        and/or nature an element plays in an <olink targetdoc="spec"
                            targetptr="gloss-content-document-epub-xhtml" type="epub-spec"/>. The <xref
                            linkend="sec-epub-type-attribute"/> is used to express domain-specific semantics in XHTML Content
                        Documents, with the inflection(s) it carries complementing the underlying <xref linkend="refHTML"/>
                        host vocabulary.</para>

                    <para>The applied semantics are intended to refine the meaning of their containing elements; they are not
                        provided to override their nature (e.g., the attribute can be used to indicate a
                            <markup>section</markup> is a chapter in a work, but is not designed to turn <markup>p</markup>
                        elements into list items to avoid proper list structures).</para>

                    <para>Semantic metadata is not intended for direct human consumption; it instead provides a controlled
                        way for Reading Systems and other User Agents to learn more about the structure and content of a
                        document, providing them the opportunity to enhance the reading experience for Users. </para>

                    <para>This specification defines a method for semantic inflection using <emphasis>the attribute
                            axis</emphasis>: instead of adding new elements, the <markup>epub:type</markup> attribute can be
                        appended to existing elements to inflect the desired semantics. A mechanism to identify external
                        vocabularies that provide controlled values for the attributes is also defined.</para>
                </section>

                <section xml:id="sec-epub-type-attribute" xreflabel="epub:type attribute">
                    <title>The <markup>epub:type</markup> Attribute</title>

                    <variablelist xreflabel="epub:type" role="elem-synopsis" xml:id="attrdef-epub-type">
                        <varlistentry>
                            <term>Attribute Name</term>
                            <listitem>
                                <para>
                                    <markup>type</markup>
                                </para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Namespace</term>
                            <listitem>
                                <para>
                                    <uri>http://www.idpf.org/2007/ops</uri>
                                </para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Usage</term>
                            <listitem>
                                <para><link xlink:href="https://www.w3.org/TR/html/dom.html#global-attributes">Global
                                        attribute</link>. <literal role="rfc2119">May</literal> be specified on all
                                    elements.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Value</term>
                            <listitem>
                                <para>A space-separated list of <olink type="epub-spec" targetptr="sec-property-datatype"
                                        targetdoc="packages">property</olink> values, with restrictions as defined in <xref
                                        linkend="sec-contentdocs-vocab-association"/>.</para>
                            </listitem>
                        </varlistentry>
                    </variablelist>

                    <para>The <markup>epub:type</markup> attribute inflects semantics on the element on which it appears. Its
                        value is one or more space-separated terms stemming from external vocabularies associated with the
                        document instance, as defined in <xref linkend="sec-contentdocs-vocab-association"/>. </para>

                    <para>The inflected semantic <literal role="rfc2119">must</literal> express a subclass of the semantic of
                        the carrying element. In the case of semantically neutral elements (such as <xref linkend="refHTML"/>
                        <markup xlink:href="https://www.w3.org/TR/html/grouping-content.html#the-div-element">div</markup>
                        and <markup xlink:href="https://www.w3.org/TR/html/textlevel-semantics.html#the-span-element"
                            >span</markup>), the inflected semantic <literal role="rfc2119">must not</literal> attach a
                        meaning that is already conveyed by an existing element (e.g., that a <markup>div</markup> represents
                        a paragraph or section). Reading Systems <literal role="rfc2119">must</literal>
                        <link linkend="confreq-rs-epubtype-prec">ignore inflected semantics</link> that conflict with the
                        carrying element.</para>

                    <para>As the <xref linkend="refHTML"/>
                        <markup xlink:href="https://www.w3.org/TR/html/document-metadata.html#the-head-element">head</markup>
                        element is a metadata container for a document, structural semantics expressed on this element or any
                        descendant of it have no meaning. Reading Systems <literal role="rfc2119">must</literal> ignore such
                        semantics.</para>

                    <bridgehead xml:id="sec-epub-type-ex">Examples</bridgehead>
                    <informalexample xml:id="ex.epubtype.note">
                        <para>The following example shows the <markup>epub:type</markup> attribute used to add footnote and
                            note reference semantics.</para>
                        <synopsis>
<xi:include href="./examples/contentdocs/epub-type-1.xml" parse="text"/></synopsis>
                    </informalexample>
                    <informalexample xml:id="ex.epubtype.gloss">
                        <para>The following example shows the <markup>epub:type</markup> attribute used to add glossary
                            semantics on an <xref linkend="refHTML"/> definition list.</para>
                        <synopsis>
<xi:include href="./examples/contentdocs/epub-type-2.xml" parse="text"/></synopsis>
                    </informalexample>
                    <informalexample xml:id="ex.epubtype.pg">
                        <para>The following example shows the <markup>epub:type</markup> attribute used to add pagebreak
                            semantics.</para>
                        <synopsis>
<xi:include href="./examples/contentdocs/epub-type-3.xml" parse="text"/></synopsis>
                    </informalexample>
                </section>

                <section xml:id="sec-contentdocs-vocab-association" xreflabel="Vocabulary Association">
                    <title>Vocabulary Association</title>

                    <para>This specification adopts the vocabulary association mechanisms defined in <olink
                            targetdoc="packages" targetptr="sec-metadata-assoc" type="epub-spec"/>, with the following
                        modifications: </para>

                    <bridgehead xml:id="sec-contentdocs-default-vocab">Default Vocabulary</bridgehead>
                    <para>The default vocabulary for Content Documents is defined to be the <link
                            linkend="refEPUBStructureVocab">EPUB 3 Structural Semantics Vocabulary</link>.</para>

                    <bridgehead xml:id="sec-contentdocs-reserved-prefixes">Reserved Prefixes</bridgehead>

                    <para>This specification reserves prefixes that Authors <literal role="rfc2119">may</literal> use in the
                            <markup>epub:type</markup> attribute in the normative document <link
                            xlink:href="http://www.idpf.org/epub/vocab/structure/pfx">EPUB Content Documents Reserved
                            Prefixes</link>.</para>

                    <bridgehead xml:id="sec-contentdocs-prefix-attr">The <markup>prefix</markup> Attribute</bridgehead>
                    <para>The <markup>prefix</markup> attribute definition is unchanged, but the attribute is defined to be
                        in the namespace <uri>http://www.idpf.org/2007/ops</uri> when used in EPUB Content Documents.</para>

                    <para>The <markup>prefix</markup> attribute is only valid on the <xref linkend="refHTML"/> root
                            <markup>html</markup> element.</para>
                </section>

                <section xml:id="sec-contentdocs-semantic-inflection-processing-reqs">
                    <title>Processing Requirements</title>

                    <para>A Reading System <literal role="rfc2119">must</literal> process the <markup>epub:type</markup>
                        attribute as follows:</para>

                    <itemizedlist role="conformance-list">
                        <listitem>
                            <para xml:id="confreq-rs-epubtype-beh">It <literal role="rfc2119">may</literal> associate
                                behaviors with none, some or all of the terms defined in the <link
                                    linkend="sec-contentdocs-default-vocab">default vocabulary</link>.</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-rs-epubtype-oth">It <literal role="rfc2119">may</literal> associate
                                behaviors with terms from other vocabularies.</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-rs-epubtype-ign">It <literal role="rfc2119">must</literal> ignore terms
                                that it does not recognize.</para>
                        </listitem>
                    </itemizedlist>

                    <para xml:id="confreq-rs-epubtype-prec">When Reading System behavior associated with a given
                            <markup>epub:type</markup> value conflicts with an element's native behavior, the behavior
                        associated with the element <literal role="rfc2119">must</literal> be given precedence.</para>
                </section>
            </section>

            <section xml:id="sec-xhtml-semantic-enrichment" xreflabel="XHTML Semantic Enrichment">
                <title>Semantic Enrichment</title>

                <section xml:id="sec-xhtml-semantic-enrichment-intro" conformance="informative">
                    <title>Introduction</title>

                    <para>Unlike <link linkend="sec-xhtml-semantic-inflection">semantic inflection</link>, which is about
                        refining the structures within your markup, semantic enrichment enables the layering of meaning into
                        the content in order to facilitate machine processing.</para>

                    <para>The <xref linkend="refMicrodata"/> and <xref linkend="refRDFa"/> specifications both define sets of
                        attributes that can be used in <olink targetdoc="spec" targetptr="gloss-content-document-epub-xhtml"
                            type="epub-spec">XHTML Content Documents</olink> to semantically enrich the content.</para>
                </section>

                <section xml:id="sec-xhtml-semantic-enrichment-content-conf">
                    <title>Content Conformance</title>

                    <para>A conformant <olink targetdoc="spec" targetptr="gloss-content-document-epub-xhtml" type="epub-spec"/>
                        <literal role="rfc2119">must</literal> meet all of the following criteria:</para>

                    <itemizedlist role="conformance-list" xml:id="xhtml-semantic-enrichment-confreqs">
                        <listitem>
                            <para xml:id="confreq-html-microdata">It <literal role="rfc2119">must</literal> allow the use of
                                    <xref linkend="refMicrodata"/> attributes as defined in that specification.</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-html-rdfa">It <literal role="rfc2119">must</literal> allow the use of <xref
                                    linkend="refRDFa"/> attributes as defined in <xref linkend="refHTMLRDFa"/>.</para>
                        </listitem>
                    </itemizedlist>
                </section>

                <section xml:id="sec-xhtml-semantic-enrichment-processing-reqs">
                    <title>Processing Requirements</title>

                    <para>Reading Systems <literal role="rfc2119">may</literal> process <xref linkend="refMicrodata"/> and
                            <xref linkend="refRDFa"/> attributes as defined in their respective specifications, but such
                        support is <literal role="rfc2119">optional</literal>.</para>
                </section>

            </section>

            <section xml:id="sec-xhtml-ssml-attrib">
                <title>SSML Attributes</title>

                <section xml:id="sec-cd-ssml-intro">
                    <title>Introduction</title>

                    <para>The W3C Speech Synthesis Markup Language <xref linkend="refSSML"/> is a language used for assisting
                            <olink targetdoc="spec" targetptr="gloss-tts" type="epub-spec"/> engines in generating synthetic
                        speech. Although SSML is designed as a standalone document type, it also defines semantics suitable
                        for use within other host languages.</para>

                    <para>This specification recasts the <xref linkend="refSSML"/>
                        <link xlink:href="https://www.w3.org/TR/2010/REC-speech-synthesis11-20100907/#S3.1.10"
                                ><markup>phoneme</markup> element</link> as two attributes â <markup>ssml:ph</markup> and
                            <markup>ssml:alphabet</markup> â and makes them available within XHTML Content Documents.</para>

                    <para>Reading Systems with <olink targetdoc="spec" targetptr="gloss-tts" type="epub-spec"/> capabilities
                            <literal role="rfc2119">should</literal> support the SSML Attributes as defined below.</para>

                    <xi:include href="./share/note-tts-features.xml"/>

                </section>

                <section xml:id="sec-cd-ssml-ph-attrib">
                    <title>The <markup>ssml:ph</markup> attribute</title>
                    <para>The <markup>ssml:ph</markup> attribute specifies a phonemic/phonetic pronunciation of the text
                        represented by the element to which the attribute is attached.</para>
                    <variablelist xreflabel="ssml:ph" role="elem-synopsis" xml:id="attrdef-ssml-ph">
                        <varlistentry>
                            <term>Attribute Name</term>
                            <listitem>
                                <para>
                                    <markup>ph</markup>
                                </para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Namespace</term>
                            <listitem>
                                <para>
                                    <uri>https://www.w3.org/2001/10/synthesis</uri>
                                </para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Usage</term>
                            <listitem>
                                <para><link xlink:href="https://www.w3.org/TR/html/dom.html#sec-global-attributes">Global
                                        attribute</link>. <literal role="rfc2119">May</literal> be specified on all elements
                                    with which a phonetic equivalent can logically be associated (e.g., elements that contain
                                    textual information).</para>
                                <para><literal role="rfc2119">Must not</literal> be specified on a descendant of an element
                                    that already carries this attribute.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Value</term>
                            <listitem>
                                <para>A phonemic/phonetic expression, syntactically valid with respect to <link
                                        linkend="sec-cd-ssml-alphabet-attrib">the phonemic/phonetic alphabet being
                                        used</link>.</para>
                            </listitem>
                        </varlistentry>
                    </variablelist>
                    <para>This attribute inherits all the semantics of the <xref linkend="refSSML"/>
                        <markup>phoneme</markup> element <markup
                            xlink:href="https://www.w3.org/TR/2010/REC-speech-synthesis11-20100907/#S3.1.10">ph</markup>
                        attribute, with the following addition:</para>
                    <itemizedlist role="conformance-list">
                        <listitem>
                            <para xml:id="ssml-ph-concat"> When the <markup>ssml:ph</markup> attribute appears on an element
                                that has text node descendants, the corresponding document text to which the pronunciation
                                applies is the string that results from concatenating the descendant text nodes, in document
                                order. The specified phonetic pronunciation <literal role="rfc2119">must</literal> therefore
                                logically match the element's textual data in its entirety (i.e., not just an isolated part
                                of its content).</para>
                        </listitem>
                    </itemizedlist>
                    <para>Reading Systems that support the SSML Attributes and <link linkend="sec-pls">PLS Documents</link>
                        <literal role="rfc2119">must</literal> honor the defined <link linkend="confreq-pls-rs-casc"
                            >precedence rules</link> for these two constructs. </para>
                </section>

                <section xml:id="sec-cd-ssml-alphabet-attrib">
                    <title>The <markup>ssml:alphabet</markup> attribute</title>

                    <para>The <markup>ssml:alphabet</markup> attribute specifies which phonemic/phonetic pronunciation
                        alphabet is used in the value of the <markup><xref linkend="attrdef-ssml-ph"/></markup>
                        attribute.</para>

                    <variablelist xreflabel="ssml:alphabet" role="elem-synopsis" xml:id="attrdef-ssml-alphabet">
                        <varlistentry>
                            <term>Attribute Name</term>
                            <listitem>
                                <para>
                                    <markup>alphabet</markup>
                                </para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Namespace</term>
                            <listitem>
                                <para>
                                    <uri>https://www.w3.org/2001/10/synthesis</uri>
                                </para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Usage</term>
                            <listitem>
                                <para><link xlink:href="https://www.w3.org/TR/html/dom.html#sec-global-attributes">Global
                                        attribute</link>. <literal role="rfc2119">May</literal> be specified on any
                                    element.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry>
                            <term>Value</term>
                            <listitem>
                                <para>The name of the pronunciation alphabet used in the value of <markup><xref
                                            linkend="attrdef-ssml-ph"/></markup> (inherited). </para>
                            </listitem>
                        </varlistentry>
                    </variablelist>

                    <para>This attribute inherits all the semantics of the <xref linkend="refSSML"/>
                        <markup>phoneme</markup> element <markup
                            xlink:href="https://www.w3.org/TR/2010/REC-speech-synthesis11-20100907/#S3.1.10"
                            >alphabet</markup> attribute, with the following addition:</para>
                    <itemizedlist role="conformance-list">
                        <listitem>
                            <para xml:id="ssml-alphabet-inherit">The value of the <markup>ssml:alphabet</markup> attribute is
                                inherited in the document tree. The pronunciation alphabet used in a given
                                    <markup>ssml:ph</markup> attribute value is determined by locating the first occurrence
                                of the <markup>ssml:alphabet</markup> attribute starting with the element on which the
                                    <markup>ssml:ph</markup> attribute appears, followed by the nearest ancestor
                                element.</para>
                        </listitem>
                    </itemizedlist>

                    <para>Reading Systems that support the <link linkend="sec-xhtml-ssml-attrib">SSML Attributes</link>
                        feature of this specification <literal role="rfc2119">should</literal> support the IPA alphabet <xref
                            linkend="refIPA"/>, as expressed by the value "<code role="value">ipa</code>".</para>
                </section>
            </section>

            <section xml:id="sec-xhtml-alternate-style-tags">
                <title>Alternate Style Tags</title>
                <para>In accordance with <xref linkend="refAlternateStyleTags"/> , the <markup>link</markup> element
                        <markup>class</markup> attribute <literal role="rfc2119">may</literal> include any of the following
                    values: <code role="value">horizontal</code>, <code role="value">vertical</code>, <code role="value"
                        >day</code> and <code role="value">night</code>. These values inherit the semantics defined by that
                    specification for their use.</para>
                <para>Reading Systems <literal role="rfc2119">should</literal> select and utilize such tagged style sets as
                    appropriate, and as described in that specification.</para>
            </section>

            <section xml:id="sec-xhtml-custom-attributes">
                <title>Custom Attributes</title>

                <para><olink targetdoc="spec" targetptr="gloss-epub-reading-system" type="epub-spec">Reading Systems</olink>
                    <literal role="rfc2119">may</literal> introduce functionality not defined in this specification to
                    enhance the rendering of <olink targetdoc="spec" targetptr="gloss-epub-publication" type="epub-spec">EPUB
                        Publications</olink>. To facilitate this experimentation, vendors <literal role="rfc2119"
                        >may</literal> define custom attributes for use in <olink targetdoc="spec"
                        targetptr="gloss-content-document-epub-xhtml" type="epub-spec">XHTML Content
                    Documents</olink>.</para>

                <para>Custom attributes <literal role="rfc2119">may</literal> be included on any element in an XHTML Content
                    Document provided such attributes are from a foreign namespace, which is defined as a namespace <xref
                        linkend="refXMLNamespaces"/> that does not map to either of the following URIs:</para>

                <itemizedlist>
                    <listitem>
                        <para><uri>http://www.w3.org/1999/xhtml</uri></para>
                    </listitem>
                    <listitem>
                        <para><uri>http://www.idpf.org/2007/ops</uri></para>
                    </listitem>
                </itemizedlist>

                <para>Custom attributes, and the behaviors associated with them, <literal role="rfc2119">must not</literal>
                    alter the integrity of an EPUB Publication. The content <literal role="rfc2119">must</literal> remain
                    consumable by a User without any information loss or other significant deterioration, regardless of the
                    Reading System it is rendered on.</para>

                <note>
                    <para>To facilitate interoperability of custom attributes across Reading Systems, vendors are strongly
                        encouraged to document any extensions they implement in <xref linkend="refAttrExtensions"/>.</para>
                </note>
            </section>
        </section>

        <section xml:id="sec-xhtml-deviations">
            <title>HTML Deviations and Constraints</title>

            <para>This section defines deviations from, and constraints on, the underlying <xref linkend="refHTML"/> document
                model applicable to EPUB 3.1 <olink targetdoc="spec" targetptr="gloss-content-document-epub-xhtml"
                    type="epub-spec">XHTML Content Documents</olink>.</para>

            <section xml:id="sec-xhtml-mathml">
                <title>Embedded MathML</title>

                <section xml:id="sec-xhtml-mathml-intro" conformance="informative">
                    <title>Introduction</title>

                    <para>XHTML Content Documents support embedded <xref linkend="refMathML"/> but limit its usage to a
                        restricted subset of the full MathML markup language.</para>

                    <para>This subset is designed to ease the implementation burden on Reading Systems and to promote
                        accessibility, while retaining compatibility with <xref linkend="refHTML"/> User Agents. </para>

                    <note>
                        <para>The <link xlink:href="http://www.idpf.org/epub/vocab/package/item/#mathml"
                                    ><property>mathml</property> property</link>
                            <xref linkend="refManifestVocab"/> of the <olink targetdoc="spec" targetptr="gloss-manifest"
                                type="epub-spec"/>
                            <markup>item</markup> element indicates that an XHTML Content Document contains embedded
                            MathML.</para>
                    </note>

                </section>

                <section xml:id="sec-xhtml-mathml-conf-content" xreflabel="Embedded MathML â Content Conformance">
                    <title>Content Conformance</title>

                    <para>Any occurrence of MathML markup in XHTML Content Documents <literal role="rfc2119">must</literal>
                        conform to the constraints expressed in the MathML specification <xref linkend="refMathML"/>, with
                        the following additional restrictions:</para>

                    <variablelist role="conformance-list">
                        <varlistentry xml:id="math-pres">
                            <term>Presentation MathML</term>
                            <listitem>
                                <para xml:id="confreq-mathml-pres">The <markup>math</markup> element <literal role="rfc2119"
                                        >must</literal> contain only <link
                                        xlink:href="https://www.w3.org/TR/2010/REC-MathML3-20101021/chapter3.html"
                                        >Presentation MathML</link>, with the exception of the
                                        <markup>annotation-xml</markup> element as defined below.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry xml:id="math-cont">
                            <term>Content MathML</term>
                            <listitem>
                                <para xml:id="confreq-mathml-annot-cont"><link
                                        xlink:href="https://www.w3.org/TR/2010/REC-MathML3-20101021/chapter4.html">Content
                                        MathML</link>
                                    <literal role="rfc2119">may</literal> be included within MathML markup in XHTML Content
                                    Documents, and, when present, <literal role="rfc2119">must</literal> occur within an
                                        <markup>annotation-xml</markup> child element of an <markup>semantics</markup>
                                    element.</para>
                                <para xml:id="confreq-mathml-annot-cont-attrs">When Content MathML is included as per the
                                    previous condition, the given <markup>annotation-xml</markup> element's
                                        <markup>encoding</markup> attribute <literal role="rfc2119">must</literal> be set to
                                    either of the functionally-equivalent values <code role="value">MathML-Content</code> or
                                        <code role="value">application/mathml-content+xml</code>, and its
                                        <markup>name</markup> attribute <literal role="rfc2119">must</literal> be set to
                                        <code role="value">contentequiv</code>. </para>
                            </listitem>
                        </varlistentry>
                        <varlistentry xml:id="math-deprecated">
                            <term>Deprecated MathML</term>
                            <listitem>
                                <para xml:id="confreq-mathml-deprecated">Elements and attributes marked as deprecated in
                                        <xref linkend="refMathML"/>
                                    <literal role="rfc2119">must not</literal> be included within MathML markup in XHTML
                                    Content Documents.</para>
                            </listitem>
                        </varlistentry>
                        <varlistentry xml:id="math-html">
                            <term>XHTML Content Document fragments</term>
                            <listitem>
                                <para xml:id="confreq-mathml-annot-xht">XHTML Content Document fragments <literal
                                        role="rfc2119">may</literal> be included within MathML markup in XHTML Content
                                    Documents, and, when present, <literal role="rfc2119">must</literal> occur within an
                                        <markup>annotation-xml</markup> child element of an <markup>semantics</markup>
                                    element.</para>
                                <para xml:id="confreq-mathml-annot-xht-attrs">When an XHTML Content Document fragment is
                                    included as per the above paragraph, the given <markup>annotation-xml</markup> element's
                                        <markup>encoding</markup> attribute <literal role="rfc2119">must</literal> be set to
                                    the media type of the parent XHTML Content Document (either <code role="value"
                                        >application/xhtml+xml</code> or <code role="value">text/html</code>) and its
                                        <markup>name</markup> attribute <literal role="rfc2119">must</literal> be set to
                                        <code role="value">alternate-representation</code>.</para>
                                <para xml:id="confreq-mathml-annot-xht-math">Any included XHTML Content Document fragments
                                        <literal role="rfc2119">must not</literal> themselves contain MathML markup.</para>
                                <para xml:id="confreq-mathml-annot-xht-model">Any included XHTML Content Document fragments
                                        <literal role="rfc2119">must</literal> conform to the content model in which the
                                    ancestor <markup>math</markup> element occurs, such that if the <markup>math</markup>
                                    element is replaced by the given XHTML Content Document fragment the document remains
                                    valid.</para>
                            </listitem>
                        </varlistentry>
                    </variablelist>

                </section>


                <section xml:id="sec-xhtml-mathml-rs-conf" xreflabel="Embedded MathML â Reading System Conformance">
                    <title>Reading System Conformance</title>

                    <para>A conformant <olink targetdoc="spec" targetptr="gloss-epub-reading-system" type="epub-spec"/>
                        <literal role="rfc2119">must</literal> meet all of the following criteria for processing MathML
                        embedded in XHTML Content Documents:</para>

                    <itemizedlist role="conformance-list" xml:id="mathml-rs-confreqs">
                        <listitem>
                            <para xml:id="confreq-mathml-rs-behavior">It <literal role="rfc2119">must</literal> support
                                processing of <link
                                    xlink:href="https://www.w3.org/TR/2010/REC-MathML3-20101021/chapter3.html">Presentation
                                    MathML</link>, and <literal role="rfc2119">may</literal> support processing of <link
                                    xlink:href="https://www.w3.org/TR/2010/REC-MathML3-20101021/chapter4.html">Content
                                    MathML</link>, using semantics defined by the MathML 3.0 specification <xref
                                    linkend="refMathML"/>.</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-mathml-rs-render">If it has a <olink targetdoc="spec"
                                    targetptr="gloss-viewport" type="epub-spec"/>, it <literal role="rfc2119">must</literal>
                                support visual rendering of Presentation MathML.</para>
                        </listitem>
                    </itemizedlist>
                </section>

                <section xml:id="sec-xhtml-mathml-alt">
                    <title>Fallback Content</title>

                    <para>As Reading System support for MathML rendering is inconsistent, <olink targetdoc="spec"
                            targetptr="gloss-author" type="epub-spec" epub:specref-exclude="true">Authors</olink> are
                        encouraged to provide a fallback image using the <markup>altimg</markup> attribute on the
                            <markup>math</markup> element. It is <literal role="rfc2119">recommended</literal> that the
                        dimension and alignment attributes (<markup>altimg-width</markup>, <markup>altimg-height</markup> and
                            <markup>altimg-valign</markup>) be used in conjunction with the <markup>altimg</markup>
                        attribute.</para>

                    <note xml:id="note-mathml-altimg-refprops-pkg">
                        <para>Fallback images have conform to the constraints for Publication Resources defined in <olink
                                targetdoc="spec" targetptr="sec-epub-pub-conf" type="epub-spec"/>.</para>
                    </note>
                </section>
            </section>

            <section xml:id="sec-xhtml-svg">
                <title>Embedded SVG</title>

                <para><olink targetdoc="spec" targetptr="gloss-content-document-epub-xhtml" type="epub-spec">XHTML Content
                        Documents</olink> support the embedding of <link
                        xlink:href="https://www.w3.org/TR/SVG/intro.html#TermSVGDocumentFragment">SVG 1.1 document
                        fragments</link>
                    <emphasis>by reference</emphasis> (embedding via reference, for example, from an <markup>img</markup> or
                        <markup>object</markup> element) and <emphasis>by inclusion</emphasis> (embedding via direct
                    inclusion of the <markup>svg</markup> element in the XHTML Content Document) <xref linkend="refSVG"
                    />.</para>

                <para>The content conformance constraints for SVG embedded in XHTML Content Documents are the same as defined
                    for <olink targetdoc="spec" targetptr="gloss-content-document-epub-svg" type="epub-spec">SVG Content
                        Documents</olink> in <xref linkend="sec-svg-restrictions"/>, with the exception that SVG embedded in
                    the HTML syntax does not have to meet the <link linkend="confreq-cd-svg-xml">XML conformance
                        requirements</link>.</para>

                <para>Reading Systems <literal role="rfc2119">must</literal> process SVG embedded in XHTML Content Documents
                    as defined in <xref linkend="sec-svg-rs-conf"/>.</para>

                <note>
                    <para>The <link xlink:href="http://www.idpf.org/epub/vocab/package/item/#svg"><property>svg</property>
                            property</link>
                        <xref linkend="refManifestVocab"/> of the <olink targetdoc="spec" targetptr="gloss-manifest"
                            type="epub-spec"/>
                        <markup>item</markup> element indicates that an XHTML Content Document contains embedded SVG.</para>
                </note>

                <!--
                    <note>
                        <para>This section defines conformance requirements for SVG embedded in
                            XHTML Content Documents. Refer to <xref linkend="sec-svg"/> for
                            conformance requirements for SVG as an EPUB Content Document.</para>
                    </note>
                    -->

                <section xml:id="sec-xhtml-svg-css">
                    <title>Embedded SVG and CSS</title>

                    <para xml:id="confreq-svg-rs-css-embed-ref">For the purposes of styling SVG embedded in XHTML Content
                        Documents <emphasis>by reference</emphasis>, Reading Systems <literal role="rfc2119">must
                            not</literal> apply CSS style rules of the containing document to the referenced SVG
                        document.</para>

                    <para xml:id="confreq-svg-rs-css-embed-inc">For the purposes of styling SVG embedded in XHTML Content
                        Documents <emphasis>by inclusion</emphasis>, Reading Systems <literal role="rfc2119">must</literal>
                        apply applicable CSS rules of the containing document to the included SVG elements.</para>

                    <note>
                        <para>SVG included <emphasis>by reference</emphasis> is processed as a separate document, and can
                            include its own CSS style rules just like an <olink targetdoc="spec"
                                targetptr="gloss-content-document-epub-svg" type="epub-spec"/> would. Note that this is
                            consistent with situations where an <xref linkend="refHTML"/>
                            <markup xlink:href="https://www.w3.org/TR/html/semantics-embedded-content.html#elementdef-object"
                                >object</markup> element references an external <xref linkend="refHTML"/> element.</para>
                    </note>

                </section>

            </section>

            <section xml:id="sec-xhtml-deviations-unicode">
                <title>Unicode Restrictions</title>

                <para>This section lists restrictions on the Unicode character repertoire.</para>

                <variablelist>
                    <varlistentry>
                        <term>Private Use Characters and Embedded Fonts</term>
                        <listitem>
                            <para xml:id="confreq-html-unicode-pua">Any included characters that map to a code point within
                                one of the Private Use Area (PUA) ranges as defined in <xref linkend="refUnicode5"/>
                                <literal role="rfc2119">must</literal> occur within a string that is styled or attributed in
                                a manner that includes a reference to an embedded font <xref linkend="refCSS3FontsModule"/>
                                that contains an appropriate glyph for that code point.</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
            </section>

            <section xml:id="sec-xhtml-deviations-discouraged">
                <title>Discouraged Constructs</title>
                <variablelist role="conformance-list">
                    <varlistentry>
                        <term>The <markup>rp</markup> Element</term>
                        <listitem>
                            <para xml:id="confreq-html-vocab-rp">The <xref linkend="refHTML"/>
                                <markup xlink:href="https://www.w3.org/TR/html/textlevel-semantics.html#the-rp-element"
                                    >rp</markup> element is intended to provide a fallback â a parenthesis display around
                                    <markup>ruby</markup> markup â for older version <olink targetdoc="spec"
                                    targetptr="gloss-epub-reading-system" type="epub-spec">Reading Systems</olink> that do
                                not recognize ruby markup. As EPUB 3.1 Reading Systems are ruby-aware, and can provide
                                fallbacks, the use of <markup>rp</markup> elements in <olink targetdoc="spec"
                                    targetptr="gloss-content-documents-html">XHTML Content Documents</olink> is
                                discouraged.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>The <markup>embed</markup> Element</term>
                        <listitem>
                            <para xml:id="confreq-html-vocab-embed">Since the <xref linkend="refHTML"/>
                                <markup
                                    xlink:href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-embed-element"
                                    >embed</markup> element does not provide intrinsic facilities to provide <link
                                    linkend="confreq-rs-scripted-flbk">fallbacks</link> for Reading Systems that do not
                                support scripting, its use is discouraged when the resource referenced has scripting
                                components. <olink targetdoc="spec" targetptr="gloss-author" type="epub-spec">Authors</olink>
                                <literal role="rfc2119">should</literal> use the <markup>object</markup> element
                                instead.</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
            </section>

            <section xml:id="sec-xhtml-fallbacks">
                <title>Foreign Resource Restrictions</title>
                <para xml:id="confreq-resources-cd-fallback">Foreign Resources <literal role="rfc2119">may</literal> be
                    referenced from elements that have intrinsic fallback mechanisms, where an intrinsic fallback method is
                    the capability to offer an alternative presentation if the foreign resource is not supported. For
                    example, most <xref linkend="refHTML"/>
                    <link xlink:href="https://www.w3.org/TR/html/dom.html#kinds-of-content-embedded-content">embedded content
                        elements</link> provide options for alternative rendering, such as allowing multiple sources to be
                    specified or allowing embedded HTML content for when a resource cannot be rendered. A <olink
                        targetdoc="spec" targetptr="gloss-publication-resource-cmt" type="epub-spec"
                        epub:specref-exclude="true"/> or embedded HTML content <literal role="rfc2119">must</literal> be
                    provided via the given element's intrinsic fallback mechanism when a Foreign Resource is
                    referenced.</para>

                <para xml:id="confreq-resources-cd-fallback-media">Flow content <literal role="rfc2119">may</literal> be
                    embedded within the <xref linkend="refHTML"/>
                    <markup xlink:href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-audio-element"
                        >audio</markup> and <markup
                        xlink:href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-video-element"
                        >video</markup> elements for rendering in older Reading Systems that do not recognize these elements
                    (e.g., EPUB 2 Reading Systems), but it does not does not represent a Core Media Type fallback.</para>

                <para>The following <xref linkend="refHTML"/> elements are exempt from <olink targetdoc="spec"
                        targetptr="confreq-cmt" type="epub-spec">Core Media Type requirements</olink> &#8212; Foreign
                    Resources <literal role="rfc2119">may</literal> be referenced from them without the provision of a Core
                    Media Type fallback:</para>

                <itemizedlist>
                    <listitem>
                        <para xml:id="confreq-resources-cd-fallback-link"><markup
                                xlink:href="https://www.w3.org/TR/html/document-metadata.html#the-link-element">link</markup>
                            &#8212; when its <markup>rel</markup> attribute has <link linkend="confreq-cd-pls-assoc">the
                                value "<code role="value">pronunciation</code>"</link></para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-resources-cd-fallback-track"><markup
                                xlink:href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-track-element"
                                >track</markup></para>
                    </listitem>
                    <listitem>
                        <para xml:id="confreq-resources-cd-fallback-video"><markup
                                xlink:href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-video-element"
                                >video</markup> &#8212; including any child <markup
                                xlink:href="https://www.w3.org/TR/html/semantics-embedded-content.html#elementdef-media-source"
                                >source</markup> elements</para>
                    </listitem>
                </itemizedlist>

                <note>
                    <para>Refer to <olink targetdoc="packages" targetptr="sec-foreign-restrictions-manifest" type="epub-spec"
                            >manifest fallbacks</olink> for the provision of fallbacks for elements without intrinsic
                        mechanisms, such as the <xref linkend="refHTML"/>
                        <markup xlink:href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-iframe-element"
                            >iframe</markup> and <markup
                            xlink:href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-img-element"
                            >img</markup> elements.</para>
                </note>
            </section>
        </section>

    </chapter>

    <chapter xml:id="sec-svg">
        <title>SVG Content Documents</title>

        <caution>
            <para>Some features of SVG are not fully supported in Reading Systems, or supported across all platforms on which
                the Reading Systems run. When utilizing such features, Authors need to consider the inherent risks in terms
                of the potential impact on interoperability and document longevity.</para>
        </caution>

        <section xml:id="sec-svg-intro" conformance="informative">
            <title>Introduction</title>

            <para>The Scalable Vector Graphics (SVG) 1.1 (Second Edition) specification <xref linkend="refSVG"/> defines a
                format for representing final-form vector graphics and text.</para>

            <para>Although an EPUB Publication typically uses <link linkend="sec-xhtml">XHTML Content Documents</link> as the
                    <olink targetdoc="spec" targetptr="gloss-content-document-top-level" type="epub-spec">top-level</olink>
                document type, the use of <olink targetdoc="spec" targetptr="gloss-content-document-epub-svg"
                    type="epub-spec">SVG Content Documents</olink> is also permitted. SVGs are typically only used in certain
                special circumstances, such as when final-form page images are the only suitable representation of the
                content (e.g., in the context of manga or comic books). </para>

            <para>This section defines a profile for <xref linkend="refSVG"/> documents. An instance of an XML document that
                conforms to this profile is a <olink targetdoc="spec" targetptr="gloss-publication-resource-cmt"
                    type="epub-spec"/> and is referred to in this specification as an <olink targetdoc="spec"
                    targetptr="gloss-content-document-epub-svg" type="epub-spec"/>.</para>

            <note>
                <para>This section defines conformance requirements for <olink targetdoc="spec"
                        targetptr="gloss-content-document-epub-svg" type="epub-spec">SVG Content Documents</olink>. Refer to
                        <xref linkend="sec-xhtml-svg"/> for conformance requirements for SVG embedded in XHTML Content
                    Documents.</para>
            </note>

        </section>
        <section xml:id="sec-svg-content-conf" xreflabel="SVG Content Documents â Content Conformance">
            <title>Content Conformance</title>
            <variablelist role="conformance-list">
                <para>An <olink targetdoc="spec" targetptr="gloss-content-document-epub-svg" type="epub-spec"/>
                    <literal role="rfc2119">must</literal> meet all of the following criteria:</para>
                <varlistentry xml:id="confreq-svg-docprops">
                    <term>Document Properties</term>
                    <listitem role="conformance-item">
                        <para xml:id="confreq-cd-svg-xml">
                            <xi:include href="./share/xml-defref.xml"/>
                        </para>
                        <para xml:id="confreq-resources-svg-fallback">It <literal role="rfc2119">may</literal> include
                            references to <olink targetdoc="spec" targetptr="gloss-publication-resource-foreign"
                                type="epub-spec">Foreign Resources</olink> provided a fallback to a <olink targetdoc="spec"
                                targetptr="gloss-publication-resource-cmt" type="epub-spec"/> is included.</para>
                        <para xml:id="confreq-cd-svg-docprops-schema">It <literal role="rfc2119">must</literal> be an <link
                                xlink:href="https://www.w3.org/TR/SVG/intro.html#TermSVGDocumentFragment">SVG 1.1 document
                                fragment</link> valid to the constructs defined in that specification, and conform to all
                            content conformance constraints expressed in <xref linkend="sec-svg-restrictions"/>.</para>

                        <note>
                            <para>The recommendation that EPUB Publications follow the accessibility requirements in <xref
                                    linkend="refA11Y"/> applies to SVG Content Documents. See <olink targetdoc="spec"
                                    targetptr="sec-epub-a11y" type="epub-spec"/>.</para>
                        </note>
                    </listitem>
                </varlistentry>
                <varlistentry xml:id="confreq-svg-fileprops">
                    <term>File Properties</term>
                    <listitem>
                        <para xml:id="confreq-svg-fileprops-name">The SVG Content Document filename <literal role="rfc2119"
                                >should</literal> use the file extension <filename>.svg</filename>.</para>
                    </listitem>
                </varlistentry>
            </variablelist>
        </section>
        <section xml:id="sec-svg-restrictions">
            <title>Restrictions on SVG</title>

            <para>This specification restricts the content model of <olink targetdoc="spec"
                    targetptr="gloss-content-document-epub-svg" type="epub-spec">SVG Content Documents</olink> and <link
                    linkend="sec-xhtml-svg">SVG embedded in XHTML Content Documents</link> as follows:</para>

            <itemizedlist role="conformance-list" xml:id="sec-svg-restrictions-list">
                <listitem>
                    <para xml:id="confreq-svg-foreignObject">The <xref linkend="refSVG"/>
                        <markup xlink:href="https://www.w3.org/TR/SVG/extend.html#ForeignObjectElement"
                            >foreignObject</markup> element <literal role="rfc2119">must</literal> contain either <xref
                            linkend="refHTML"/>
                        <link xlink:href="https://www.w3.org/TR/html/dom.html#kinds-of-content-flow-content">flow
                            content</link> or exactly one <xref linkend="refHTML"/>
                        <link xlink:href="https://www.w3.org/TR/html/sections.html#the-body-element"><markup>body</markup>
                            element</link>. This content <literal role="rfc2119">must</literal> represent a valid document
                        fragment of the XHTML Content Document model defined in <xref linkend="sec-xhtml-conf-content"/>. The
                            <markup>foreignObject</markup> element's <markup>requiredExtensions</markup> attribute, if given,
                            <literal role="rfc2119">must</literal> be set to <uri>http://www.idpf.org/2007/ops</uri>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-svg-title">The <xref linkend="refSVG"/>
                        <markup xlink:href="https://www.w3.org/TR/SVG/struct.html#TitleElement">title</markup> element
                            <literal role="rfc2119">must</literal> contain only valid XHTML Content Document Phrasing
                        content.</para>
                </listitem>
            </itemizedlist>

        </section>
        <section xml:id="sec-svg-rs-conf" xreflabel="SVG Content Documents â Reading System Conformance">
            <title>Reading System Conformance</title>

            <para>A conformant <olink targetdoc="spec" targetptr="gloss-epub-reading-system" type="epub-spec"/>
                <literal role="rfc2119">must</literal> meet all of the following criteria for processing SVG Content
                Documents and SVG <link linkend="sec-xhtml-svg">embedded in XHTML Content Documents</link>:</para>

            <itemizedlist role="conformance-list" xml:id="svg-rs-confreqs">
                <listitem>
                    <para xml:id="confreq-svg-rs-behavior">Unless explicitly defined by this specification as overridden, it
                            <literal role="rfc2119">must</literal> process SVG Content Documents using semantics defined by
                        the <xref linkend="refSVG"/> specification and honor any applicable User Agent conformance
                        constraints expressed therein.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-svg-rs-scrpt">It <literal role="rfc2119">must</literal> meet the Reading System
                        conformance criteria defined in <xref linkend="sec-scripted-content-rs-reqs"/>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-svg-rs-css">If it has an <olink targetdoc="spec" targetptr="gloss-viewport-svg"
                            type="epub-spec"/>, it <literal role="rfc2119">must</literal> support the visual rendering of SVG
                        using CSS as defined in <link xlink:href="https://www.w3.org/TR/SVG/styling.html">Styling</link>
                        <xref linkend="refSVG"/>, and it <literal role="rfc2119">should</literal> support all properties
                        defined in <link xlink:href="https://www.w3.org/TR/SVG/propidx.html">Property Index</link>
                        <xref linkend="refSVG"/>. In the case of embedded SVG, it <literal role="rfc2119">must</literal> also
                        conform to the constraints defined in <xref linkend="sec-xhtml-svg-css"/>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-svg-rs-text">It <literal role="rfc2119">should</literal> support User selection and
                        searching of text within SVG elements.</para>
                </listitem>
                <!-- not needed as we changed confreq-svg-rs-behavior
                    <listitem>
                        <para xml:id="confreq-svg-rs-links">It <literal role="rfc2119">must</literal> recognize SVG links (i.e., the
                                <markup>a</markup> element), and if it supports exposing links to
                            Users for activation, then these links <literal role="rfc2119">must</literal> be exposed. </para>
                    </listitem>
                    -->
                <listitem>
                    <para xml:id="confreq-svg-rs-reqdExt">It <literal role="rfc2119">must</literal> recognize the value
                            <uri>http://www.idpf.org/2007/ops</uri> of the <markup>requiredExtensions</markup> attribute when
                        appearing on the <markup>switch</markup> and <markup>foreignObject</markup> elements as representing
                        the occurrence of XHTML Content Document fragments.</para>
                </listitem>
            </itemizedlist>
        </section>
        <section xml:id="sec-svg-semantic-inflection" xreflabel="SVG Semantic Inflection">
            <title>Semantic Inflection</title>

            <para>The synatx and semantics defined in <xref linkend="sec-xhtml-semantic-inflection"/> are inherited for use
                of the <markup linkend="attrdef-epub-type">epub:type</markup> and <markup
                    linkend="sec-contentdocs-prefix-attr">epub:prefix</markup> attributes in <olink targetdoc="spec"
                    targetptr="gloss-content-document-epub-svg" type="epub-spec" epub:specref-exclude="true">SVG Content
                    Documents</olink>.</para>

            <para>The use of the <markup>epub:prefix</markup> attribute is valid on the root <markup>svg</markup> element in
                SVG Content Documents. Prefixes used in <link linkend="sec-xhtml-svg">embedded SVG</link>
                <literal role="rfc2119">must</literal> be declared on the <xref linkend="refHTML"/> root <link
                    xlink:href="https://www.w3.org/TR/html/semantics.html#the-html-element"><markup>html</markup>
                    element</link>, as defined in <xref linkend="sec-xhtml-semantic-inflection"/>.</para>
        </section>
    </chapter>

    <chapter xml:id="sec-css">
        <title>CSS Style Sheets</title>

        <section xml:id="sec-css-intro" conformance="informative">
            <title>Introduction</title>

            <para>CSS has been an integral part of the Open Web Platform for nearly two decades â readers, publishers, and
                document authors expect CSS to "just work," as they expect HTML to just work.</para>

            <para>In the past, EPUB defined a profile of CSS that mandated support for certain properties and provided
                prefixed versions of numerous other properties. Although the CSS Working Group no longer recommends the use
                of prefixed properties, this specification has to maintain some prefixed properties to avoid breaking
                existing content. But with the minor exceptions defined in this section, EPUB defers to the W3C to define
                CSS.</para>
        </section>

        <section xml:id="sec-css-content-conf" xreflabel="CSS Style Sheets â Content Conformance">
            <title>Content Conformance</title>

            <para>A conformant CSS style sheet <literal role="rfc2119">must</literal> meet all of the following
                criteria:</para>

            <itemizedlist role="conformance-list">
                <listitem>
                    <para xml:id="confreq-css-props">It <literal role="rfc2119">may</literal> include any CSS properties,
                        with the following exceptions:</para>
                    <itemizedlist role="conformance-list">
                        <listitem>
                            <para xml:id="confreq-css-props-exc-direction">It <literal role="rfc2119">must not</literal> use
                                the <link xlink:href="https://www.w3.org/TR/css3-writing-modes/#direction"
                                        ><property>direction</property> property</link>
                                <xref linkend="refCSS3WritingModesModule"/>. Use the <xref linkend="refHTML"/>
                                <link xlink:href="https://www.w3.org/TR/html/dom.html#the-dir-attribute"><markup>dir</markup>
                                    attribute</link> to set the inline base direction.</para>
                        </listitem>
                        <listitem>
                            <para xml:id="confreq-css-props-exc-unicode-bidi">It <literal role="rfc2119">must not</literal>
                                use the <link xlink:href="https://www.w3.org/TR/css3-writing-modes/#unicode-bidi"
                                        ><property>unicode-bidi</property> property</link>
                                <xref linkend="refCSS3WritingModesModule"/>. Use <xref linkend="refHTML"/>
                                <link xlink:href="https://www.w3.org/TR/html/textlevel-semantics.html#the-bdo-element"
                                        ><markup>bdo</markup> elements</link> and <link
                                    xlink:href="https://www.w3.org/TR/html/dom.html#the-dir-attribute"><markup>dir</markup>
                                    attributes</link> to control bidirectionality.</para>
                        </listitem>
                    </itemizedlist>
                </listitem>
                <listitem>
                    <para xml:id="confreq-css-prefixed">It <literal role="rfc2119">may</literal> include the prefixed
                        properties defined in <xref linkend="sec-css-prefixed"/>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-css-encoding">It <literal role="rfc2119">must</literal> be encoded in UTF-8 or
                        UTF-16 <xref linkend="refUnicode5"/>.</para>
                </listitem>
            </itemizedlist>

            <note>
                <para>Keep in mind that some <olink targetdoc="spec" targetptr="gloss-epub-reading-system" type="epub-spec"
                        >Reading Systems</olink> will not support all desired features of CSS. In particular, the following
                    are known to be problematic:</para>
                <itemizedlist>
                    <listitem>
                        <para>Reading System-induced pagination can interact poorly with style sheets. Pagination is
                            sometimes done using columns, which can result in incorrect values for viewport sizes. Fixed and
                            absolute positioning are particularly likely to be problematic.</para>
                    </listitem>
                    <listitem>
                        <para>Some types of screens will not support animations and transitions.</para>
                    </listitem>
                </itemizedlist>
            </note>
        </section>

        <section xml:id="sec-css-rs-conf" xreflabel="CSS Style Sheets â Reading System Conformance">
            <title>Reading System Conformance</title>

            <para>A conformant <olink targetdoc="spec" targetptr="gloss-epub-reading-system" type="epub-spec"/>
                <literal role="rfc2119">must</literal> meet all of the following criteria for processing CSS Style
                Sheets:</para>

            <itemizedlist role="conformance-list">
                <listitem>
                    <para xml:id="confreq-css-rs-support">It <literal role="rfc2119">must</literal> support the official
                        definition of CSS as described in the <xref linkend="refCSSSNAP"/>, if it has a <olink
                            targetdoc="spec" targetptr="gloss-viewport" type="epub-spec"/>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-css-rs-modules">It <literal role="rfc2119">should</literal> support all applicable
                        modules in <xref linkend="refCSSSNAP"/> that have reached at least <link
                            xlink:href="https://www.w3.org/2015/Process-20150901/#candidate-rec">Candidate
                            Recommendation</link> status <xref linkend="refW3CProc"/> (and are widely implemented).</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-css-rs-prefixed">It <literal role="rfc2119">must</literal> support all prefixed
                        properties defined in <xref linkend="sec-css-prefixed"/>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-css-rs-html-default">In addition to supporting CSS properties as defined above, its
                        user agent style sheet <literal role="rfc2119">should</literal> support the <xref linkend="refHTML"/>
                        <link xlink:href="https://www.w3.org/TR/html/rendering.html#rendering">suggested default
                            rendering</link>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-css-rs-overrides">It <literal role="rfc2119">should</literal> respect Author CSS
                        and <olink targetdoc="spec" targetptr="gloss-user" type="epub-spec" epub:specref-exclude="true"/>
                        styles as defined in <xref linkend="sec-css-rs-overrides"/>.</para>
                </listitem>
            </itemizedlist>

            <para>Reading System developers are encouraged to implement CSS support at the level of major browsers.</para>
        </section>

        <section xml:id="sec-css-prefixed" xreflabel="CSS Style Sheets â Prefixed Properties">
            <title>Prefixed Properties</title>

            <caution>
                <para><olink targetdoc="spec" targetptr="gloss-author" type="epub-spec">Authors</olink> are strongly
                    encouraged to use unprefixed properties, and <olink targetdoc="spec"
                        targetptr="gloss-epub-reading-system" type="epub-spec">Reading Systems</olink> to support current CSS
                    specifications. The widely-used prefixed properties from <xref linkend="refContentDocs301"/> have been
                    retained, but support for the other properties has been removed. Authors are advised to use CSS-native
                    solutions for the removed properties where and when they are available.</para>
                <para>Authors currently using these prefixed properties are advised to move to unprefixed versions as soon as
                    support allows, as these properties are not anticipated to be supported in the next major version of
                    EPUB.</para>
            </caution>

            <section xml:id="sec-css-prefixed-writing-modes">
                <title>CSS Writing Modes</title>

                <para>The following table lists the <property>-epub-</property> prefixed properties for <xref
                        linkend="refCSS3WritingModesModule"/>. The Value column indicates the value the property accepts. The
                    Prior EPUB Mapping column indicates values/properties that were used in previous versions of EPUB 3. An
                    asterisk (*) denotes that the older property or value is now deprecated. The final column describes how
                    to implement the prefixed property based on <xref linkend="refCSS3WritingModesModule-2015-dated"
                    />.</para>

                <table>
                    <caption>CSS Writing Modes Properties</caption>
                    <thead>
                        <tr>
                            <th>Property</th>
                            <th>Value</th>
                            <th>Prior EPUB Mapping</th>
                            <th>Mapping to <xref linkend="refCSS3WritingModesModule-2015-dated"/></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><property>-epub-text-orientation</property></td>
                            <td><markup>upright</markup></td>
                            <td><markup>upright</markup></td>
                            <td><markup>upright</markup></td>
                        </tr>
                        <tr>
                            <td><property>-epub-text-orientation</property></td>
                            <td><markup>mixed</markup></td>
                            <td><markup>vertical-right</markup>*</td>
                            <td><markup>mixed</markup></td>
                        </tr>
                        <tr>
                            <td><property>-epub-text-orientation</property></td>
                            <td><markup>sideways-right</markup></td>
                            <td><markup>sideways-right</markup></td>
                            <td><markup>sideways</markup></td>
                        </tr>
                        <tr>
                            <td><property>-epub-text-orientation</property></td>
                            <td><markup>sideways-right</markup></td>
                            <td><markup>rotate-right</markup>*</td>
                            <td><markup>sideways</markup></td>
                        </tr>
                        <tr>
                            <td><property>-epub-text-orientation</property></td>
                            <td><markup>sideways</markup></td>
                            <td><markup>rotate-normal</markup>*</td>
                            <td><markup>sideways</markup></td>
                        </tr>
                        <tr>
                            <td><property>-epub-text-orientation</property></td>
                            <td><markup>sideways</markup></td>
                            <td><markup>sideways</markup></td>
                            <td><markup>sideways</markup></td>
                        </tr>
                        <tr>
                            <td><property>-epub-text-orientation</property></td>
                            <td><markup>mixed</markup></td>
                            <td><markup>mixed</markup></td>
                            <td><markup>mixed</markup></td>
                        </tr>
                        <tr>
                            <td><property>-epub-writing-mode</property></td>
                            <td><markup>horizontal-tb</markup></td>
                            <td><markup>horizontal-tb</markup></td>
                            <td><markup>horizontal-tb</markup></td>
                        </tr>
                        <tr>
                            <td><property>-epub-writing-mode</property></td>
                            <td><markup>vertical-rl</markup></td>
                            <td><markup>vertical-rl</markup></td>
                            <td><markup>vertical-rl</markup></td>
                        </tr>
                        <tr>
                            <td><property>-epub-writing-mode</property></td>
                            <td><markup>vertical-lr</markup></td>
                            <td><markup>vertical-lr</markup></td>
                            <td><markup>vertical-lr</markup></td>
                        </tr>
                        <tr>
                            <td><property>-epub-text-combine</property>*</td>
                            <td><property>-epub-text-combine-horizontal: none</property></td>
                            <td><markup>none</markup></td>
                            <td><markup>text-combine-upright: none</markup></td>
                        </tr>
                        <tr>
                            <td><property>-epub-text-combine</property>*</td>
                            <td><property>-epub-text-combine-horizontal: all</property></td>
                            <td><markup>horizontal</markup></td>
                            <td><markup>text-combine-upright: all</markup></td>
                        </tr>
                        <tr>
                            <td><property>-epub-text-combine</property>*</td>
                            <td>Error</td>
                            <td><markup>horizontal &lt;number&gt;</markup></td>
                            <td><property>text-combine-upright: digits &lt;number&gt;</property></td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section xml:id="sec-css-prefixed-text">
                <title>CSS Text Level 3</title>
                <table>
                    <caption>CSS Text Level 3 Properties</caption>
                    <thead>
                        <tr>
                            <th>Property</th>
                            <th>Value</th>
                            <th>Mapping to <xref linkend="refCSS3Text"/></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><property>-epub-hyphens</property></td>
                            <td><markup>none | manual | auto</markup></td>
                            <td>No Change</td>
                        </tr>
                        <tr>
                            <td><property>-epub-hyphens</property></td>
                            <td><markup>all</markup></td>
                            <td>Not Supported</td>
                        </tr>
                        <tr>
                            <td><property>-epub-line-break</property></td>
                            <td><markup>auto | loose | normal | strict</markup></td>
                            <td>No Change</td>
                        </tr>
                        <tr>
                            <td><property>-epub-text-align-last</property></td>
                            <td><markup>auto | start | end | left | right | center | justify</markup></td>
                            <td>No Change</td>
                        </tr>
                        <tr>
                            <td><property>-epub-word-break</property></td>
                            <td><markup>normal | keep-all | break-all</markup></td>
                            <td>No Change</td>
                        </tr>
                        <tr>
                            <td><property>text-transform</property></td>
                            <td><markup>-epub-fullwidth</markup></td>
                            <td><property>text-transform: full-width</property></td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section xml:id="sec-css-prefixed-text-decoration">
                <title>CSS Text Decoration Level 3</title>
                <table>
                    <caption>CSS Text Decoration Level 3 Properties</caption>
                    <thead>
                        <tr>
                            <th>Property</th>
                            <th>Value</th>
                            <th>Mapping to <xref linkend="refCSS3TextDecoration"/></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><property>-epub-text-emphasis-color</property></td>
                            <td><markup>&lt;color&gt;</markup></td>
                            <td>No Change</td>
                        </tr>
                        <tr>
                            <td><property>-epub-text-emphasis-position </property></td>
                            <td><markup>[ over | under ] &amp;&amp; [ right | left ]</markup></td>
                            <td>No Change</td>
                        </tr>
                        <tr>
                            <td><property>-epub-text-emphasis-style</property></td>
                            <td><markup>none | [ [ filled | open ] || [ dot | circle | double-circle | triangle | sesame ] ]
                                    | &lt;string&gt;</markup></td>
                            <td>No Change</td>
                        </tr>
                        <tr>
                            <td><property>-epub-text-underline-position</property></td>
                            <td><markup>auto | [ under || [ left | right ] ]</markup></td>
                            <td>No Change</td>
                        </tr>
                        <tr>
                            <td><property>-epub-text-underline-position</property></td>
                            <td><markup>alphabetic</markup></td>
                            <td><property>text-underline-position: auto</property></td>
                        </tr>
                    </tbody>
                </table>
            </section>
        </section>

        <section xml:id="sec-css-rs-overrides">
            <title>Reading System Overrides</title>

            <para><olink targetdoc="spec" targetptr="gloss-epub-reading-system" type="epub-spec">EPUB Reading Systems</olink>
                <literal role="rfc2119">should</literal> apply <olink targetdoc="spec" targetptr="gloss-author"
                    type="epub-spec"/> style sheets as written to <olink targetdoc="spec"
                    targetptr="gloss-content-document-epub" type="epub-spec">EPUB Content Documents</olink>. If a Reading
                System allows, <olink targetdoc="spec" targetptr="gloss-user" type="epub-spec">Users</olink>
                <literal role="rfc2119">should</literal> be able to override Author style sheets as desired. EPUB Reading
                Systems <literal role="rfc2119">should not</literal> override Author style sheets unless strictly
                necessary.</para>

            <para>If a Reading System has to override an Author style sheet, it <literal role="rfc2119">should</literal> do
                so in a way that preserves the Cascade: through a user agent style sheet, the <link
                    xlink:href="https://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/css.html#CSS-OverrideAndComputed"
                        ><markup>getOverrideStyle</markup> method</link>
                <xref linkend="refDOM2CSS"/>, or <xref linkend="refHTML"/>
                <link xlink:href="https://www.w3.org/TR/html/dom.html#the-style-attribute"><markup>style</markup>
                    attributes</link>.</para>

            <para>Developers of Reading Systems are strongly encouraged to publicly document their user agent style sheets
                and how they interact with Author style sheets.</para>
        </section>
    </chapter>

    <chapter xml:id="sec-scripted-content">
        <title>Scripting</title>

        <para><olink targetdoc="spec" targetptr="gloss-content-document-epub" type="epub-spec">EPUB Content Documents</olink>
            <literal role="rfc2119">may</literal> contain scripting using the facilities defined for this in the respective
            underlying specifications (<xref linkend="refHTML"/> and <xref linkend="refSVG"/>). When an EPUB Content Document
            contains scripting, it is referred to in this specification as a <olink targetdoc="spec"
                targetptr="gloss-content-document-epub-scripted" type="epub-spec"/>. This label also applies to <olink
                targetdoc="spec" targetptr="gloss-content-document-epub-xhtml" type="epub-spec">XHTML Content
                Documents</olink> when they contain instances of <link
                xlink:href="https://www.w3.org/TR/html/sec-forms.html#sec-forms">HTML forms</link>.</para>

        <section xml:id="sec-scripted-context">
            <title>Scripting Contexts</title>

            <para xml:id="sec-scripted-content-models">This specification defines two contexts in which scripts <literal
                    role="rfc2119">may</literal> appear:</para>

            <variablelist>
                <varlistentry xml:id="sec-scripted-content-type-spine-level" xreflabel="spine-level">
                    <term>spine-level</term>
                    <listitem>
                        <para>An instance of the <xref linkend="refHTML"/>
                            <markup xlink:href="https://www.w3.org/TR/html/semantics-scripting.html#the-script-element"
                                >script</markup> element included in a <olink targetdoc="spec"
                                targetptr="gloss-content-document-top-level" type="epub-spec"/>.</para>
                    </listitem>
                </varlistentry>
                <varlistentry xml:id="sec-scripted-content-type-container-constrained" xreflabel="container-constrained">
                    <term>container-constrained</term>
                    <listitem>
                        <para>An instance of the <xref linkend="refHTML"/>
                            <markup>script</markup> element included in an <olink targetdoc="spec"
                                targetptr="gloss-content-document-epub" type="epub-spec"/> that is embedded in a parent
                            Content Document using the <xref linkend="refHTML"/>
                            <markup
                                xlink:href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-iframe-element"
                                >iframe</markup> element.</para>
                    </listitem>
                </varlistentry>
            </variablelist>

            <para>In both of the above-defined contexts, whether the JavaScript code is embedded directly in the
                    <markup>script</markup> element or referenced via its <markup>src</markup> attribute makes no difference
                to the executing context.</para>

            <para>Which context a script is used in determines the rights and restrictions that a Reading System places on
                it. Refer to <link linkend="sec-scripted-content-content-reqs">Content Conformance</link> and <link
                    linkend="sec-scripted-content-rs-reqs">Reading System Conformance</link> for some specific requirements
                that have to be adhered to (not all Reading Systems will provide the same scripting functionality).</para>

            <bridgehead xml:id="sec-script-ex">Example</bridgehead>

            <para>Consider the following example Package Document:</para>

            <informalexample>
                <synopsis><xi:include href="examples/contentdocs/scriptcontext-01.xml" parse="text"/></synopsis>
            </informalexample>

            <para>and the following file <filename>scripted01.xhtml</filename>:</para>

            <informalexample>
                <synopsis><xi:include href="examples/contentdocs/scriptcontext-02.xml" parse="text"/></synopsis>
            </informalexample>

            <para>and the following file <filename>scripted02.xhtml</filename>:</para>

            <informalexample>
                <synopsis><xi:include href="examples/contentdocs/scriptcontext-03.xml" parse="text"/></synopsis>
            </informalexample>

            <para>From these examples, it is true that:</para>

            <itemizedlist>
                <listitem>
                    <para>the code in the <markup>script</markup> element in the <markup>head</markup> in
                            <filename>scripted01.xhtml</filename> is a spine-level script because the document is referenced
                        from the spine;</para>
                </listitem>
                <listitem>
                    <para>the code in the <markup>script</markup> element in <filename>scripted02.xhtml</filename> is a
                        container-constrained script because the HTML file it occurs in is included in
                            <filename>scripted01.xhtml</filename> via the <markup>iframe</markup> element.</para>
                </listitem>
            </itemizedlist>

        </section>

        <section xml:id="sec-scripted-content-content-reqs" xreflabel="Scripted Content Documents â Content Conformance">
            <title>Content Conformance</title>

            <variablelist role="conformance-list">
                <varlistentry>
                    <term>Container-constrained scripts</term>
                    <listitem>
                        <para xml:id="confreq-cd-scripted-container">A container-constrained script <literal role="rfc2119"
                                >must not</literal> contain instructions for modifying the DOM of the parent Content Document
                            or other contents in the EPUB Publication, and <literal role="rfc2119">must not</literal> contain
                            instructions for manipulating the size of its containing rectangle.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Spine-level scripts</term>
                    <listitem>
                        <para xml:id="confreq-cd-scripted-spine">EPUB Content Documents that include <xref
                                linkend="sec-scripted-content-type-spine-level"/> scripting <literal role="rfc2119"
                                >must</literal> utilize the <emphasis>progressive enhancement technique</emphasis>, which for
                            the purposes of this specification has the following definition: when the document is rendered by
                            a Reading System without scripting support or with scripting support disabled, the <olink
                                targetdoc="spec" targetptr="gloss-content-document-top-level" type="epub-spec">top-level
                                document content</olink>
                            <literal role="rfc2119">must</literal> retain its integrity, remaining consumable by the User
                            without any information loss or other significant deterioration.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>Accessibility</term>
                    <listitem>
                        <para xml:id="confreq-cd-scripted-a11y">EPUB Content Documents that include scripting â using any
                                <link linkend="sec-scripted-content-models">inclusion model</link> â <literal role="rfc2119"
                                >should</literal> employ relevant accessibility techniques to ensure that the content remains
                            consumable by all Users. <xref linkend="refARIA"/>
                            <xref linkend="refWCAG20"/>
                        </para>
                    </listitem>
                </varlistentry>
                <varlistentry xml:id="confreq-cd-scripted-flbk" xreflabel="Fallbacks for Scripted Content Documents">
                    <term>Fallbacks</term>
                    <listitem>
                        <!--
                            <para xml:id="confreq-cd-scripted-flbk-canvas">EPUB Content Documents
                                that include the HTML <markup>canvas</markup> element for scripting
                                purposes <literal role="rfc2119">should</literal> include non-scripted fallback content using the
                                intrinsic model for fallback as defined by <markup>canvas</markup>
                                <xref linkend="refHTML"/>.</para>
                            <para xml:id="confreq-cd-scripted-flbk-object">EPUB Content Documents
                                that include the HTML <markup>object</markup> element for scripting
                                purposes <literal role="rfc2119">should</literal> include non-scripted fallback content using the
                                intrinsic model for fallback as defined by <markup>object</markup>
                                <xref linkend="refHTML"/>.</para> -->
                        <para xml:id="confreq-cd-scripted-fallback">EPUB Content Documents that include scripting â using any
                                <link linkend="sec-scripted-content-models">inclusion model</link> â <literal role="rfc2119"
                                >may</literal> provide fallbacks for such content, either by using intrinsic fallback
                            mechanisms (such as those available for the <xref linkend="refHTML"/>
                            <markup
                                xlink:href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-object-element"
                                >object</markup> and <markup
                                xlink:href="https://www.w3.org/TR/html/semantics-scripting.html#the-canvas-element"
                                >canvas</markup> elements) or, when an intrinsic fallback is not applicable, by using a
                                <olink targetdoc="packages" targetptr="sec-foreign-restrictions-manifest" type="epub-spec"
                                >manifest-level</olink> fallback.</para>
                        <para xml:id="confreq-cd-scripted-foreign-resources">Authors <literal role="rfc2119">must</literal>
                            ensure that any output scripts generate meets <olink targetdoc="spec"
                                targetptr="sec-core-media-types" type="epub-spec">Core Media Type
                            requirements</olink>.</para>
                    </listitem>
                </varlistentry>
            </variablelist>
            <note>
                <para>The <link xlink:href="http://www.idpf.org/epub/vocab/package/item/#scripted"
                            ><property>scripted</property> property</link>
                    <xref linkend="refManifestVocab"/> of the <olink targetdoc="spec" targetptr="gloss-manifest"
                        type="epub-spec"/>
                    <markup>item</markup> element indicates that an EPUB Content Document is a <olink targetdoc="spec"
                        targetptr="gloss-content-document-epub-scripted" type="epub-spec"/>.</para>
            </note>
            <!-- TODO handler note -->
        </section>

        <section xml:id="sec-scripted-content-rs-reqs" xreflabel="Scripted Content Documents â Reading System Conformance">
            <title>Reading System Conformance</title>

            <para>A Reading System that supports scripting <literal role="rfc2119">must</literal> meet the following
                criteria:</para>

            <itemizedlist role="conformance-list">
                <listitem>
                    <para xml:id="confreq-rs-scripted-reflow-support">It <literal role="rfc2119">should</literal> support
                            <xref linkend="sec-scripted-content-type-container-constrained"/> scripting in reflowable EPUB
                        Content Documents.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-rs-scripted-fxl-support">It <literal role="rfc2119">should</literal> support <xref
                            linkend="sec-scripted-content-type-spine-level"/> scripting in <link linkend="sec-fixed-layouts"
                            >fixed-layout documents</link>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-rs-scripted-scrolled">It <literal role="rfc2119">should</literal> support
                        spine-level scripting in reflowable EPUB Content Documents that use the <link
                            xlink:href="epub-packages.html#flow-scrolled-doc">"<property>scrolled-doc</property>"</link> or
                            <link xlink:href="epub-packages.html#flow-scrolled-continuous"
                                >"<property>scrolled-continuous</property>"</link> presentation modes defined by <olink
                            targetdoc="packages" targetptr="layout-property-flow" type="epub-spec"/>. Similarly, if it
                        supports spine-level scripting in reflowable EPUB Content Documents, it <literal role="rfc2119"
                            >must</literal> implement the "<property>scrolled-doc</property>" presentation mode and <literal
                            role="rfc2119">should</literal> implement the "<property>scrolled-continuous</property>"
                        presentation mode.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-rs-scripted-optional-support">It <literal role="rfc2119">may</literal> support
                        scripting in other contexts, but this specification does not address such scripting. As a result, the
                        use of scripting in these contexts might not be consistent across Reading Systems.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-rs-scripted-ua">It <literal role="rfc2119">may</literal> render <olink
                            targetdoc="spec" targetptr="gloss-content-document-epub-scripted" type="epub-spec">Scripted
                            Content Documents</olink> as an interactive, scripted User Agent according to <xref
                            linkend="refHTML"/>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-rs-scripted-container">It <literal role="rfc2119">must not</literal> allow a
                        container-constrained script to modify the DOM of the parent Content Document or other contents in
                        the EPUB Publication, and <literal role="rfc2119">must not</literal> allow it to manipulate the size
                        of its containing rectangle. (Note: Even if a script is not container-constrained, the Reading System
                            <literal role="rfc2119">may</literal> impose restrictions on modifications (see also the <link
                            linkend="feature-dom-manipulation">dom-manipulation feature</link>).)</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-rs-scripted-limit">It <literal role="rfc2119">may</literal> place additional
                        limitations on the capabilities provided to scripts during execution (e.g., limiting
                        networking).</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-rs-scripted-readingsystem-object">It <literal role="rfc2119">must</literal>
                        implement the JavaScript <markup>navigator</markup> extension object
                            <markup>epubReadingSystem</markup> defined in <xref linkend="app-epubReadingSystem"/>. It also
                            <literal role="rfc2119">must</literal> support the <markup>dom-manipulation</markup> and
                            <markup>layout-change</markup> features defined in <xref linkend="app-ers-hasFeature-features"/>
                        in container-constrained scripting contexts.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-rs-scripted-prop">It <literal role="rfc2119">must</literal> regard the <link
                            xlink:href="http://www.idpf.org/epub/vocab/package/item/#scripted">
                            <property>scripted</property> property</link>
                        <xref linkend="refManifestVocab"/> of the <olink targetdoc="spec" targetptr="gloss-package-document"
                            type="epub-spec"/>
                        <olink targetdoc="spec" targetptr="gloss-manifest" type="epub-spec"/>
                        <markup>item</markup> element as the authoritative definition of whether an EPUB Content Document
                        includes scripting.</para>
                </listitem>
            </itemizedlist>

            <para>A Reading System that does not support scripting <literal role="rfc2119">must</literal> meet the following
                criteria:</para>

            <itemizedlist role="conformance-list">
                <listitem>
                    <para xml:id="confreq-rs-scripted-flbk">It <literal role="rfc2119">must</literal> process fallbacks for
                        scripted content as defined in <xref linkend="confreq-cd-scripted-flbk"/>.</para>
                </listitem>
            </itemizedlist>

            <note>
                <para>Reading Systems might render Scripted Content Documents in a manner that disables other EPUB
                    capabilities and/or provides a different rendering and User experience (e.g., by disabling
                    pagination).</para>

                <para>Authors choosing to restrict the usage of scripting to the <xref
                        linkend="sec-scripted-content-type-container-constrained"/> model will ensure a more consistent User
                    experience between scripted and non-scripted content (e.g., consistent pagination behavior).</para>

                <para>Authors are advised to use declarative techniques whenever practical to increase the interoperability,
                    longevity and accessibility of their EPUB Publications, and avoid the inclusion of scripting whenever
                    practical.</para>
            </note>
        </section>

        <section xml:id="sec-scripted-content-security" conformance="informative">
            <title>Security Considerations</title>

            <para>All EPUB <olink targetdoc="spec" targetptr="gloss-author" type="epub-spec">Authors</olink> and Reading
                System developers have to be aware of the security issues that arise when scripted content is executed by a
                Reading System. As the underlying scripting model employed by Reading Systems and browsers is the same, the
                same kinds of issues encountered in Web contexts have to be taken into consideration.</para>

            <para>Each Reading System has to establish if the scripts in a particular document are to be trusted or not. It
                is advised that all scripts be treated as untrusted (and potentially malicious), and that all vectors of
                attack be examined and protected against. In particular, the following need to be considered:</para>

            <itemizedlist>
                <listitem>
                    <para>an attack against the runtime environment (e.g., stealing files from a <olink targetdoc="spec"
                            targetptr="gloss-user" type="epub-spec">User's</olink> hard drive);</para>
                </listitem>
                <listitem>
                    <para>an attack against the Reading System itself (e.g., stealing a list of a User's books or causing
                        unexpected behavior);</para>
                </listitem>
                <listitem>
                    <para>an attack of one Content Document against another (e.g., stealing data that originated in a
                        different document);</para>
                </listitem>
                <listitem>
                    <para>an attack of an unencrypted script against an encrypted portion of a document (e.g., an injected
                        malicious script extracting protected content);</para>
                </listitem>
                <listitem>
                    <para>an attack against the local network (e.g., stealing data from a server behind a firewall).</para>
                </listitem>
            </itemizedlist>

            <para>The following recommendations are provided as a guide to handling untrusted scripts:</para>

            <itemizedlist>
                <listitem>
                    <para>Reading Systems need to behave as if a unique domain were allocated to each Content Document, as
                        browser-based security relies heavily on document URLs and domains. Adopting this approach will
                        isolate documents from each other and from other Internet domains, thereby limiting access to
                        external URLs, cookies, DOM storage, etc.</para>
                    <para>Reading Systems that enable scripting and network access also need to consider including methods to
                        notify the User that network activity is occurring and/or that allow them to disable it.</para>
                    <note>
                        <para>In practice, Reading Systems might share domains across documents, but they still need to
                            maintain isolation between documents.</para>
                        <para>If parts of a document are encrypted and parts are not, or if different encryption keys are
                            used for different parts of the document, a unique per-document domain might not provide
                            sufficient protection.</para>
                    </note>
                </listitem>
                <listitem>
                    <para>If a Reading System allows persistent data to be stored, that data needs to be treated as
                        sensitive. Scripts might save persistent data through cookies and DOM storage, but Reading Systems
                        might block such attempts. Reading Systems that do allow data to be stored have to ensure that it is
                        not made available to other unrelated documents (e.g., ones that could have been spoofed). In
                        particular, checking for a matching document identifier (or similar metadata) is not a valid method
                        to control access to persistent data.</para>
                    <para>Reading Systems that allow local storage also need to provide methods for Users to inspect,
                        disable, or delete that data. The data needs to be destroyed if the corresponding EPUB Publication is
                        deleted.</para>
                </listitem>
            </itemizedlist>

            <para>Note that compliance with these recommendations does not guarantee protection from the possible attacks
                listed above; developers have to examine each potential vulnerability within the context of their Reading
                System.</para>
        </section>

        <section xml:id="sec-scripted-content-events" conformance="informative">
            <title>Event Model Considerations</title>

            <para>Reading Systems need to follow the DOM Event model as per <xref linkend="refHTML"/> and pass UI events to
                the scripting environment before performing any default action associated with these events. Reading System
                implementers need to ensure that scripts cannot disable critical functionality (such as navigation) to
                constrain the extent to which a <link linkend="sec-scripted-content-events">potentially malicious</link>
                script could impact their Reading Systems. As a result, although the scripting environment needs to be able
                to cancel the default action of any event, some events either might not be passed through or might not be
                cancelable.</para>

            <para><olink targetdoc="spec" targetptr="gloss-author" type="epub-spec">Authors</olink> need to take into account
                the wide variety of possible Reading System implementations when adding scripting functionality to their EPUB
                Publications (e.g., not all devices have physical keyboard, and in many cases a soft keyboard is only
                activated only for text input elements). Consequently, relying on keyboard events alone is not advised;
                alternative ways to trigger the desired action always need to be provided.</para>

        </section>

    </chapter>

    <chapter xml:id="sec-fixed-layouts">
        <title>Fixed Layouts</title>

        <section xml:id="sec-fxl-overview" conformance="informative">
            <title>Introduction</title>

            <para>This section defines rules for the expression and interpretation of dimensional properties of <olink
                    targetdoc="spec" targetptr="gloss-content-document-epub" type="epub-spec">EPUB Content Documents</olink>
                marked as <property>pre-paginated</property> in the <olink targetdoc="spec"
                    targetptr="gloss-package-document" type="epub-spec"/>.</para>

            <para>This specification does not define how the <link
                    xlink:href="https://www.w3.org/TR/2011/REC-CSS2-20110607/visudet.html#containing-block-details">initial
                    containing block</link>
                <xref linkend="refCSS21"/> will be placed within the Reading System content display area.</para>

            <note>
                <para>Refer to <olink targetdoc="packages" targetptr="sec-package-metadata-fxl" type="epub-spec"/> for
                    information on how to designate that a <olink targetdoc="spec" targetptr="gloss-rendition"
                        type="epub-spec"/>, or its individual spine items, are to be rendered in a pre-paginated manner
                    (i.e., with fixed width and height dimensions).</para>
            </note>
        </section>

        <section xml:id="sec-fxl-rs-conf" xreflabel="Fixed Layouts â Reading System Conformance">
            <title>Reading System Conformance</title>

            <para>A conformant <olink targetdoc="spec" targetptr="gloss-epub-reading-system" type="epub-spec"/>
                <literal role="rfc2119">must</literal> meet all of the following criteria for processing <olink
                    targetdoc="spec" targetptr="gloss-fixed-layout-document" type="epub-spec">Fixed-Layout
                Documents</olink>:</para>

            <itemizedlist role="conformance-list" xml:id="image-rs-confreqs">
                <listitem>
                    <para xml:id="confreq-fxl-rs-viewport">It <literal role="rfc2119">should</literal> allocate the full
                        content rendering area for the document.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-fxl-rs-html">It <literal role="rfc2119">must</literal> use the dimensions expressed
                        in the <property>viewport</property>
                        <markup>meta</markup> tag to render <olink targetdoc="spec"
                            targetptr="gloss-content-document-epub-xhtml" type="epub-spec">XHTML Content Documents</olink>,
                        but <literal role="rfc2119">may</literal> obtain these dimensions from the package <olink
                            targetdoc="packages" targetptr="fxl-property-viewport" type="epub-spec"/>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-fxl-rs-svg">It <literal role="rfc2119">must</literal> use the dimensions expressed
                        in the <markup>viewBox</markup> attribute to render <olink targetdoc="spec"
                            targetptr="gloss-content-document-epub-svg" type="epub-spec">SVG Content Documents</olink>, but
                            <literal role="rfc2119">may</literal> obtain these dimensions from the package <olink
                            targetdoc="packages" targetptr="fxl-property-viewport" type="epub-spec"/>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-fxl-rs-content-precedence">It <literal role="rfc2119">must</literal> use the
                        dimensions expressed in the content in the case of discrepancies with the package <olink
                            targetdoc="packages" targetptr="fxl-property-viewport" type="epub-spec"/>.</para>
                </listitem>
            </itemizedlist>
        </section>

        <section xml:id="sec-fxl-synthetic-spreads">
            <title>Viewport Rendering</title>

            <para>When rendering Fixed-Layout Documents, the default intent is that the content rendering area <literal
                    role="rfc2119">should</literal> occupy as much of the available application screen area as possible.
                Reading Systems <literal role="rfc2119">should not</literal> inject additional content such as border,
                margins, headers or footers into the viewport or the application area surrounding the viewport.</para>

            <note>
                <para>The exposure of Reading System control widgets to the <olink targetdoc="spec" targetptr="gloss-user"
                        type="epub-spec"/> is implementation-specific and not included in the above behavioral
                    expectations.</para>
            </note>
        </section>

        <section xml:id="sec-fxl-html-svg-dimensions">
            <title>Content Dimensions for HTML and SVG</title>

            <para>Each <olink targetdoc="spec" targetptr="gloss-content-document-epub" type="epub-spec"/> referenced from a
                spine item that has the <property>pre-paginated</property> value set <literal role="rfc2119">must</literal>
                contain the <property role="html">viewport</property> (for HTML) or <markup>viewBox</markup> (for SVG)
                dimension expressions as defined below, regardless of whether the value is set via the global <olink
                    targetdoc="packages" targetptr="fxl-property-layout" type="epub-spec">rendition:layout property</olink>
                for the <olink targetdoc="spec" targetptr="gloss-rendition" type="epub-spec"/> or on a <olink
                    targetdoc="packages" targetptr="fxl-property-layout-overrides" type="epub-spec">spine-level
                    override</olink>.</para>

            <para>For both HTML and SVG Content Documents, the dimension expressions define the CSS initial containing block
                (ICB) expressed in CSS Pixels <xref linkend="refCSS21"/>.</para>

            <section xml:id="sec-fxl-icb-html">
                <title>Expressing ICB Dimensions in HTML</title>

                <para>For XHTML Content Documents, the ICB dimensions <literal role="rfc2119">must</literal> be expressed in
                    a <property>viewport</property>
                    <markup>meta</markup> tag using the syntax defined in <xref linkend="refMetaTags"/>. In this version of
                    this specification, only the width and height expressions <literal role="rfc2119">must</literal> be
                    recognized by Reading Systems.</para>

                <informalexample>
                    <para>The following example shows a <property role="html">viewport</property>
                        <markup>meta</markup> tag.</para>
                    <synopsis>
<xi:include href="./examples/contentdocs/fxl-xhtml-01.xml" parse="text"/></synopsis>
                </informalexample>

                <para>Reading Systems <literal role="rfc2119">must</literal> clip XHTML content to the ICB dimensions
                    declared in the <property role="html">viewport</property>
                    <markup>meta</markup> tag; content positioned outside of the initial containing block will not be
                    visible. When the ICB aspect ratio does not match the aspect ratio of the Reading System content display
                    area, Reading Systems <literal role="rfc2119">may</literal> position the ICB inside the area to
                    accommodate the user interface; in other words, added letter-boxing space <literal role="rfc2119"
                        >may</literal> appear on either side (or both) of the content.</para>
            </section>

            <section xml:id="sec-fxl-icb-svg">
                <title>Expressing ICB Dimensions in SVG</title>

                <para>For <olink targetdoc="spec" targetptr="gloss-content-document-top-level" type="epub-spec"
                        epub:specref-exclude="true">top-level</olink> SVG Content Documents, the ICB's aspect ratio <literal
                        role="rfc2119">should</literal> be derived from the <xref linkend="refSVG"/>
                    <code xlink:href="https://www.w3.org/TR/SVG/coords.html#ViewBoxAttribute">viewBox</code> attribute, if
                    present; otherwise, the <xref linkend="refSVG"/>
                    <code xlink:href="https://www.w3.org/TR/SVG/struct.html#SVGElementHeightAttribute">height</code> and
                        <code xlink:href="https://www.w3.org/TR/SVG/struct.html#SVGElementWidthAttribute">width</code>
                    attributes <literal role="rfc2119">should</literal> be used. In the absence of these attributes, Reading
                    Systems <literal role="rfc2119">should</literal> use the best estimate of the expected aspect ratio,
                    which is typically the bounds of the window into which the content is being rendered.</para>

                <note>
                    <para>Authors are strongly encouraged to provide the <markup>viewBox</markup> or <markup>height</markup>
                        and <markup>width</markup> attributes, as the Reading System determined aspect ratio is typically
                        device-dependent and can negatively affect the rendering.</para>

                </note>
                <informalexample>
                    <para>The following example shows a <markup>viewBox</markup> attribute declaration.</para>
                    <synopsis>
<xi:include href="./examples/contentdocs/fxl-svg-01.xml" parse="text"/></synopsis>
                </informalexample>
            </section>
        </section>
    </chapter>

    <chapter xml:id="sec-pls">
        <title>Pronunciation Lexicons</title>

        <section xml:id="sec-pls-intro" conformance="informative">
            <title>Introduction</title>

            <para>The W3C Pronunciation Lexicon Specification <xref linkend="refPLS"/> defines syntax and semantics for
                XML-based pronunciation lexicons to be used by Automatic Speech Recognition and <olink targetdoc="spec"
                    targetptr="gloss-tts" type="epub-spec"/> engines.</para>

            <para>The following sections define conformance criteria for PLS documents when included in <olink
                    targetdoc="spec" targetptr="gloss-epub-publication" type="epub-spec">EPUB Publications</olink>, and rules
                for associating PLS Documents with <olink targetdoc="spec" targetptr="gloss-content-document-epub-xhtml"
                    type="epub-spec">XHTML Content Documents</olink>. </para>

            <xi:include href="./share/note-tts-features.xml"/>

        </section>

        <section xml:id="sec-pls-conf-pub">
            <title>EPUB Publication Conformance</title>

            <para>A conformant <olink targetdoc="spec" targetptr="gloss-rendition" type="epub-spec"/> of an <olink
                    targetdoc="spec" targetptr="gloss-epub-publication" type="epub-spec"/>
                <literal role="rfc2119">must</literal> meet all of the following criteria for inclusion of PLS
                Documents:</para>

            <itemizedlist role="conformance-list">
                <listitem>
                    <para xml:id="confreq-cd-pls-xht">PLS Documents <literal role="rfc2119">may</literal> be associated with
                            <olink targetdoc="spec" targetptr="gloss-content-document-epub-xhtml" type="epub-spec">XHTML
                            Content Documents</olink>. Each XHTML Content Document <literal role="rfc2119">may</literal>
                        contain zero or more PLS Document associations. </para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-cd-pls-assoc">PLS Documents <literal role="rfc2119">must</literal> be associated
                        with the <olink targetdoc="spec" targetptr="gloss-content-document-epub-xhtml" type="epub-spec"/> to
                        which they apply using the <xref linkend="refHTML"/>
                        <markup xlink:href="https://www.w3.org/TR/html/document-metadata.html#the-link-element">link</markup>
                        element with its <markup>rel</markup> attribute set to <property role="html">pronunciation</property>
                        and its <markup>type</markup> attribute set to the PLS media type (<code role="media-type"
                            >application/pls+xml</code>).</para>
                    <para xml:id="confreq-cd-pls-assoc-lang">The <markup>link</markup> element <markup>hreflang</markup>
                        attribute <literal role="rfc2119">should</literal> be specified on each PLS <markup>link</markup>,
                        and its value <literal role="rfc2119">must</literal> match <link
                            xlink:href="https://www.w3.org/TR/2008/REC-pronunciation-lexicon-20081014/#S4.1">the language for
                            which the pronunciation lexicon is relevant</link>
                        <xref linkend="refPLS"/> when specified.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-pls-pub-cont">PLS Documents <literal role="rfc2119">must</literal> meet the content
                        conformance criteria defined in <xref linkend="sec-pls-conf-content"/>.</para>
                </listitem>
                <listitem>
                    <para xml:id="confreq-pls-pub-manif">PLS Documents <literal role="rfc2119">must</literal> be represented
                        and located as defined in <olink targetdoc="packages" targetptr="sec-package-content-conformance"
                            type="epub-spec"/>.</para>
                </listitem>
            </itemizedlist>

            <bridgehead xml:id="sec-pls-ex">Examples</bridgehead>
            <informalexample>
                <para>The following example shows two PLS Documents (one for Chinese and one for Mongolian) associated with
                    an XHTML Content Document.</para>
                <synopsis>
<xi:include href="./examples/contentdocs/pls-assoc-1.xml" parse="text"/></synopsis>
            </informalexample>

        </section>

        <section xml:id="sec-pls-conf-content" xreflabel="PLS Documents â Content Conformance">
            <title>Content Conformance</title>

            <para>A PLS Document <literal role="rfc2119">must</literal> meet all of the following criteria:</para>

            <variablelist role="conformance-list" xml:id="confreq-cd-pls">
                <varlistentry xml:id="confreq-cd-pls-docprops">
                    <term>Document Properties</term>
                    <listitem>
                        <para xml:id="confreq-cd-pls-xml">
                            <xi:include href="./share/xml-defref.xml"/>
                        </para>
                        <para xml:id="confreq-cd-pls-docprops-schema">It <literal role="rfc2119">must</literal> be valid to
                            the RELAX NG schema for PLS documents available at the URI <uri
                                xlink:href="https://www.w3.org/TR/2008/REC-pronunciation-lexicon-20081014/pls.rng"
                                >https://www.w3.org/TR/2008/REC-pronunciation-lexicon-20081014/</uri>
                            <xref linkend="refPLS"/>. </para>
                    </listitem>
                </varlistentry>
                <varlistentry xml:id="confreq-cd-pls-fileprops">
                    <term>File Properties</term>
                    <listitem>
                        <para xml:id="confreq-cd-pls-fileprops-name">The PLS Document filename <literal role="rfc2119"
                                >should</literal> use the file extension <filename>.pls</filename>.</para>
                    </listitem>
                </varlistentry>
            </variablelist>

        </section>

        <section xml:id="sec-pls-conf-rs" xreflabel="PLS Documents â Reading System Conformance">
            <title>Reading System Conformance</title>

            <para>A conformant <olink targetdoc="spec" targetptr="gloss-epub-reading-system" type="epub-spec"/>
                <literal role="rfc2119">must</literal> meet all of the following criteria for processing PLS
                Documents:</para>

            <itemizedlist role="conformance-list" xml:id="pls-rs-confreqs">
                <listitem>
                    <para xml:id="confreq-pls-rs-sptts">Reading Systems with <olink targetdoc="spec" targetptr="gloss-tts"
                            type="epub-spec"/> capabilities <literal role="rfc2119">should</literal> support PLS.</para>
                    <para xml:id="confreq-pls-rs-proc">Reading Systems that support PLS <literal role="rfc2119"
                            >must</literal> process PLS documents as defined in <xref linkend="refPLS"/>.</para>
                    <para xml:id="confreq-pls-rs-scope">Reading Systems that support PLS <literal role="rfc2119"
                            >must</literal> apply the supplied pronunciation instructions to all text nodes in the current
                        XHTML Content Document whose <link
                            xlink:href="https://www.w3.org/TR/html/dom.html#the-lang-and-xmllang-attributes">language</link>
                        <xref linkend="refHTML"/> matches <link
                            xlink:href="https://www.w3.org/TR/2008/REC-pronunciation-lexicon-20081014/#S4.1">the language for
                            which the pronunciation lexicon is relevant</link>
                        <xref linkend="refPLS"/>. The algorithm for matching language tags is defined in <link
                            linkend="refRFC5646">BCP47</link>.</para>
                    <para xml:id="confreq-pls-rs-multi"> When a pronunciation rule is specified more than once for a given
                        string target in a given language, the last occurrence of the rule takes precedence, in such a way
                        that any previously-defined pronunciation rule gets overridden. </para>
                    <para xml:id="confreq-pls-rs-casc">Reading Systems that support PLS and the <link
                            linkend="sec-xhtml-ssml-attrib">SSML Attributes</link>
                        <literal role="rfc2119">must</literal> let any pronunciation instructions provided via the <markup
                            linkend="sec-cd-ssml-ph-attrib">ssml:ph</markup> attribute take precedence in cases where a
                            <markup>pls:grapheme</markup> matches a text node of an element that carries the
                            <markup>ssml:ph</markup> attribute.</para>
                </listitem>
            </itemizedlist>
        </section>

    </chapter>

    <appendix xml:id="app-epubReadingSystem">
        <title>JavaScript epubReadingSystem Object</title>

        <section xml:id="app-ers-syntax">
            <title>Syntax</title>

            <para role="syntax"><emphasis>ReadingSystem</emphasis> = navigator.epubReadingSystem;</para>

        </section>

        <section xml:id="app-ers-idl">
            <title>IDL</title>

            <para>This specification extends the <xref linkend="refHTML"/> Navigator object as follows.</para>

            <informalexample>
                <synopsis>[Exposed=(Window)]
interface EpubReadingSystem {
    [Unforgeable] readonly attribute DOMString name;
    [Unforgeable] readonly attribute DOMString version;
    [Unforgeable] readonly attribute DOMString layoutStyle;
    [Unforgeable] boolean hasFeature(DOMString feature, optional DOMString version);
};

partial interface Navigator {
    [Unforgeable, SameObject] readonly attribute EpubReadingSystem epubReadingSystem;
};</synopsis>
                <para><xref linkend="refWebIDL"/> notation.</para>
            </informalexample>

            <note>
                <para>This specification does not define an <markup>epubReadingSystem</markup> property extension for the
                        <xref linkend="refWebWorkers"/>
                    <markup xlink:href="https://www.w3.org/TR/2015/WD-workers-20150924/#the-workernavigator-object"
                        >WorkerNavigator</markup> object. Reading Systems therefore do not have to expose the
                        <markup>epubReadingSystem</markup> object in the scripting context of Workers, and Authors cannot
                    rely on its presence.</para>
            </note>

        </section>

        <section xml:id="app-ers-desc">
            <title>Description</title>

            <para>The <markup>epubReadingSystem</markup> object provides an interface through which a <olink targetdoc="spec"
                    targetptr="gloss-content-document-epub-scripted" type="epub-spec"/> can query information about a <olink
                    targetdoc="spec" targetptr="gloss-user" type="epub-spec"/>'s <olink targetdoc="spec"
                    targetptr="gloss-epub-reading-system" type="epub-spec">Reading System</olink>.</para>

            <para>The object exposes a number of <link linkend="app-ers-properties">properties</link>, about the Reading
                System, such as its name and version, and provides the <link linkend="app-ers-hasFeature">hasFeature</link>
                method which can be invoked to determine the features it supports.</para>

            <informalexample>
                <para>Example JavaScript function that displays the name of the current Reading System.</para>
                <synopsis>alert("Reading System name: " + navigator.epubReadingSystem.name);</synopsis>
            </informalexample>

            <para>Reading Systems <literal role="rfc2119">must</literal> expose the <markup>epubReadingSystem</markup> object
                on the <markup>navigator</markup> object of all loaded Scripted Content Documents, including any nested <link
                    linkend="sec-scripted-content-type-container-constrained">container-constrained</link> scripting
                contexts. Reading Systems <literal role="rfc2119">must</literal> ensure that the
                    <markup>epubReadingSystem</markup> object is available no later than when the <link
                    xlink:href="https://www.w3.org/TR/html/syntax.html#the-end"><markup>DOMContentLoaded</markup> event is
                    triggered</link>
                <xref linkend="refHTML"/>.</para>

            <note>
                <para>Reading systems implementations might create cloned instances of the <code>epubReadingSystem</code>
                    object in Scripted Content Documents for technical feasibility reasons. In such cases, the Reading System
                    has to ensure that the objectâs state &#8212; as reflected by the values of its properties and methods
                    &#8212; is consistently maintained across all copied instances.</para>
            </note>

        </section>

        <section xml:id="app-ers-properties">
            <title>Properties</title>

            <para>The following properties <literal role="rfc2119">must</literal> be made available for retrieving
                information about the Reading System.</para>

            <table xml:id="tbl-epubReadingSystem-properties">
                <caption>Required epubReadingSystem properties</caption>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr xml:id="propdef-name">
                        <td><property role="js">name</property></td>
                        <td>Returns a <code role="datatype">String</code> value representing the name of the Reading System
                            (e.g., "<code role="value">iBooks</code>", "<code role="value">Kindle</code>").</td>
                    </tr>
                    <tr>
                        <td xml:id="propdef-version"><property role="js">version</property></td>
                        <td>Returns a <code role="datatype">String</code> value representing the version of the Reading
                            System (e.g., "<code role="value">1.0</code>", "<code role="value">2.1.1</code>").</td>
                    </tr>
                    <tr>
                        <td xml:id="propdef-layoutStyle"><property role="js">layoutStyle</property>
                            <olink targetdoc="spec" targetptr="deprecated" type="epub-spec" epub:specref-exclude="true"
                                >[deprecated]</olink></td>
                        <td><para>Returns a <code role="datatype">String</code> value representing the style of layout for
                                the content.</para>
                            <para>A Reading System will typically return one of the values "<code role="value"
                                    >paginated</code>" or "<code role="value">scrolling</code>", but <literal role="rfc2119"
                                    >may</literal> define values for any additional layout formats it supports.</para></td>
                    </tr>
                </tbody>
            </table>
        </section>


        <section xml:id="app-ers-methods">
            <title>Methods</title>

            <section xml:id="app-ers-hasFeature">
                <title>hasFeature</title>

                <section xml:id="app-ers-hasFeature-syntax">
                    <title>Syntax</title>

                    <para role="syntax">hasFeature(feature[, version])</para>
                </section>

                <section xml:id="app-ers-hasFeature-desc">
                    <title>Description</title>

                    <para>The <markup>hasFeature</markup> method returns a boolean value indicating whether any version of
                        the specified feature is supported, or <code role="value">undefined</code> if the specified feature
                        is not recognized.</para>
                    <para>The <literal role="rfc2119">optional</literal>
                        <markup>version</markup> parameter is included for querying custom features that could change in
                        incompatible ways over time. The return value indicates support only for the specified version of the
                        feature.</para>
                    <para><olink targetdoc="spec" targetptr="gloss-author" type="epub-spec" epub:specref-exclude="true"
                            >Authors</olink>
                        <literal role="rfc2119">should not</literal> include a version number when querying <link
                            linkend="app-ers-hasFeature-features">features defined in this specification</link> â these
                        features are considered versionless. If a Reading System supports a feature defined in this
                        specification, it <literal role="rfc2119">must</literal> ignore any supplied version number and
                        return a <code role="value">true</code> value.</para>

                    <informalexample>
                        <para>Example JavaScript function that displays whether the current Reading System supports scripted
                            manipulation of the DOM.</para>
                        <synopsis>var feature = "dom-manipulation";

var conformTest = navigator.epubReadingSystem.hasFeature(feature);

alert("Feature " + feature + " supported?: " + conformTest);</synopsis>
                    </informalexample>
                </section>

                <section xml:id="app-ers-hasFeature-features">
                    <title>Features</title>

                    <para>The following table lists the set of features that Reading Systems that support the
                            <markup>epubReadingSystem</markup> object <literal role="rfc2119">must</literal> recognize (i.e.,
                        provide a return value for). Support for these features is <literal role="rfc2119"
                        >optional</literal>. </para>

                    <table xml:id="tbl-epubReadingSystem-features">
                        <caption>Required epubReadingSystem features</caption>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td xml:id="feature-dom-manipulation"><code role="value">dom-manipulation</code></td>
                                <td>Scripts <literal role="rfc2119">may</literal> make structural changes to the documentâs
                                    DOM (applies to spine-level scripting only).</td>
                            </tr>
                            <tr>
                                <td xml:id="feature-layout-changes"><code role="value">layout-changes</code></td>
                                <td>Scripts <literal role="rfc2119">may</literal> modify attributes and CSS styles that
                                    affect content layout (applies to spine-level scripting only).</td>
                            </tr>
                            <tr>
                                <td xml:id="feature-touch-events"><code role="value">touch-events</code></td>
                                <td>The device supports touch events and the Reading System passes touch events to the
                                    content.</td>
                            </tr>
                            <tr>
                                <td xml:id="feature-mouse-events"><code role="value">mouse-events</code></td>
                                <td>The device supports mouse events and the Reading System passes mouse events to the
                                    content.</td>
                            </tr>
                            <tr>
                                <td xml:id="feature-keyboard-events"><code role="value">keyboard-events</code></td>
                                <td>The device supports keyboard events and the Reading System passes keyboard events to the
                                    content.</td>
                            </tr>
                            <tr>
                                <td xml:id="feature-spine-scripting"><code role="value">spine-scripting</code></td>
                                <td>Indicates whether the Reading System supports spine-level scripting (e.g., so a
                                    container-constrained script can determine whether any actions that depend on scripting
                                    support in a <olink targetdoc="spec" targetptr="gloss-content-document-top-level"
                                        type="epub-spec" epub:specref-exclude="true">Top-level Content Document</olink> have
                                    any chance of success before attempting them).</td>
                            </tr>
                        </tbody>
                    </table>

                    <para>Additional features <literal role="rfc2119">may</literal> be added by Reading System developers,
                        but future versions of this specification might append to this list in ways that could conflict or be
                        incompatible with any such custom additions.</para>
                </section>
            </section>
        </section>
    </appendix>

    <xi:include href="./share/contributors.xml"/>

    <xi:include href="./share/references.xml"/>
</book>
